{"version":3,"file":"454.bundle.c1a1093c102977b6c35d.js","mappings":"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","sources":["webpack:///../../../../../fhir-integration/src/fhircast/fhircastTestData.js","webpack:///../../../../../fhir-integration/src/fhircast/FhircastPanel.tsx","webpack:///../../../../../fhir-integration/src/fhircast/PowercastPanel.tsx","webpack:///../../../../../fhir-integration/src/fhircast/powercast.js","webpack:///../../../../../fhir-integration/src/fhircast/getCustomizationModule.tsx","webpack:///../../../../../fhir-integration/src/services/FhircastService.ts","webpack:///../../../../../fhir-integration/src/index.tsx","webpack:///../../../../../fhir-integration/src/fhircast/getPanelModule.tsx"],"sourcesContent":["const testData=  [\n\n\n  {\n    label: \"ImagingStudy-open\",\n    value: \"ImagingStudy-open\",\n    eventObject: {\n      \"timestamp\": \"2018-01-08T01:37:05.14\",\n    \"id\": \"q9v3jubddqt63n1\",\n    \"event\": {\n      \"hub.topic\": \"fdb2f928-5546-4f52-87a0-0648e9ded065\",\n      \"hub.event\": \"imagingstudy-open\",\n      \"context\": [\n        {\n          \"key\": \"patient\",\n          \"resource\": {\n            \"resourceType\": \"Patient\",\n            \"id\": \"ewUbXT9RWEbSj5wPEdgRaBw3\",\n            \"identifier\": [\n              {\n                \"system\": \"urn:oid:1.2.840.114350\",\n                \"value\": \"185444\"\n              },\n              {\n                \"system\": \"urn:oid:1.2.840.114350.1.13.861.1.7.5.737384.27000\",\n                \"value\": \"2667\"\n              }\n            ]\n          }\n        },\n        {\n          \"key\": \"study\",\n          \"resource\": {\n            \"resourceType\": \"ImagingStudy\",\n            \"id\": \"8i7tbu6fby5ftfbku6fniuf\",\n            \"uid\": \"urn:oid:2.16.840.1.114362.1.11972228.22789312658.616067305.306.2\",\n            \"identifier\": [\n              {\n                \"system\": \"7678\",\n                \"value\": \"185444\"\n              }\n            ],\n            \"patient\": {\n              \"reference\": \"Patient/ewUbXT9RWEbSj5wPEdgRaBw3\"\n            }\n          }\n        }\n      ]\n    }\n  }\n},\n\n{\n  label: \"ImagingStudy-close\",\n  value: \"ImagingStudy-close\",\n  eventObject: {\n    \"timestamp\": \"2018-01-08T01:37:05.14\",\n  \"id\": \"q9v3jubddqt63n1\",\n  \"event\": {\n    \"hub.topic\": \"fdb2f928-5546-4f52-87a0-0648e9ded065\",\n    \"hub.event\": \"imagingstudy-close\",\n    \"context\": [\n      {\n        \"key\": \"patient\",\n        \"resource\": {\n          \"resourceType\": \"Patient\",\n          \"id\": \"ewUbXT9RWEbSj5wPEdgRaBw3\",\n          \"identifier\": [\n            {\n              \"system\": \"urn:oid:1.2.840.114350\",\n              \"value\": \"185444\"\n            },\n            {\n              \"system\": \"urn:oid:1.2.840.114350.1.13.861.1.7.5.737384.27000\",\n              \"value\": \"2667\"\n            }\n          ]\n        }\n      },\n      {\n        \"key\": \"study\",\n        \"resource\": {\n          \"resourceType\": \"ImagingStudy\",\n          \"id\": \"8i7tbu6fby5ftfbku6fniuf\",\n          \"uid\": \"urn:oid:2.16.840.1.114362.1.11972228.22789312658.616067305.306.2\",\n          \"identifier\": [\n            {\n              \"system\": \"7678\",\n              \"value\": \"185444\"\n            }\n          ],\n          \"patient\": {\n            \"reference\": \"Patient/ewUbXT9RWEbSj5wPEdgRaBw3\"\n          }\n        }\n      }\n    ]\n  }\n}\n},\n{\n  label: \"Patient-open\",\n  value: \"Patient-open\",\n  eventObject: {\"timestamp\":\"\",\n              \"id\":\"\",\n              \"event\":{\n                \"hub.topic\":\"b073c35e-d86e-4ae0-a8b7-e8804dc50fd1\",\n                \"hub.event\":\"patient-open\",\n                \"context\":[{  \n                  \"key\":\"patient\",\n                  \"resource\":{\n                    \"resourceType\":\"Patient\",\n                    \"id\":\"645d87b8-4710-4837-97f4-aeecf3566ac8\",\n                    \"identifier\":[{\n                      \"type\":{\n                        \"coding\":[{\n                          \"system\":\"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                          \"code\":\"MR\",\"display\":\"Medical Record Number\"}]\n                        },\n                      \"value\":\"M1\"\n                      }]\n                  }}]}}\n},\n{\n  label: \"Patient-close\",\n  value: \"Patient-close\",\n  eventObject: {\"timestamp\":\"\",\n              \"id\":\"\",\n              \"event\":{\n                \"hub.topic\":\"b073c35e-d86e-4ae0-a8b7-e8804dc50fd1\",\n                \"hub.event\":\"patient-close\",\n                \"context\":[{  \n                  \"key\":\"patient\",\n                  \"resource\":{\n                    \"resourceType\":\"Patient\",\n                    \"id\":\"645d87b8-4710-4837-97f4-aeecf3566ac8\",\n                    \"identifier\":[{\n                      \"type\":{\n                        \"coding\":[{\n                          \"system\":\"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                          \"code\":\"MR\",\"display\":\"Medical Record Number\"}]}}]}}]}}\n},\n\n  {\n    label: \"[RAD-148] DiagnoticReport-open\",\n    value: \"[RAD-148] DiagnoticReport-open\",\n    eventObject: {\n        \"timestamp\": \"\",\n        \"id\": \"\",\n        \"event\": {\n          \"hub.topic\": \"\",\n          \"hub.event\": \"diagnosticreport-open\",\n          \"context\": [\n            {\n              \"key\": \"report\",\n              \"resource\": {\n                \"resourceType\": \"DiagnosticReport\",\n                \"id\": \"2402d3bd-e988-414b-b7f2-4322e86c9327\",\n                \"status\": \"unknown\",\n                \"basedOn\" : [\n                  {\n                    \"type\" : \"ServiceRequest\",\n                    \"identifier\" : {\n                      \"type\" : {\n                        \"coding\" : [\n                          {\n                            \"system\" : \"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                            \"code\" : \"ACSN\"\n                          }\n                        ]\n                      },\n                      \"system\" : \"urn:oid:2.16.840.1.113883.19.5\",\n                      \"value\" : \"GH339884\",\n                      \"assigner\" : {\n                        \"reference\" : \"Organization/a92ac1be-fb34-49c1-be58-10928bd271cc\",\n                        \"display\" : \"My Healthcare Provider\"\n                      }\n                    }\n                  }\n                ],\n                \"code\" : {\n                  \"coding\" : [\n                    {\n                      \"system\" : \"http://loinc.org\",\n                      \"code\" : \"19005-8\",\n                      \"display\": \"Radiology Imaging study [Impression] (narrative)\"\n                    }\n                  ]\n                },\n                \"subject\": {\n                  \"reference\": \"Patient/503824b8-fe8c-4227-b061-7181ba6c3926\"\n                },\n                \"study\": [\n                  {\n                    \"reference\": \"ImagingStudy/e25c1d31-20a2-41f8-8d85-fe2fdeac74fd\"\n                  }\n                ]\n              }\n            },\n            {\n              \"key\": \"study\",\n              \"resource\": {\n                \"resourceType\": \"ImagingStudy\",\n                \"id\": \"e25c1d31-20a2-41f8-8d85-fe2fdeac74fd\",\n                \"identifier\": [\n                  {\n                    \"system\" : \"urn:dicom:uid\",\n                    \"value\" : \"urn:oid:2.16.840.1.114362.1.11972228.22789312658.616067305.306.2\"\n                  }\n                ],\n                \"status\": \"unknown\",\n                \"subject\": {\n                  \"reference\": \"Patient/503824b8-fe8c-4227-b061-7181ba6c3926\"\n                },\n                \"basedOn\" : [\n                  {\n                    \"type\" : \"ServiceRequest\",\n                    \"identifier\" : {\n                      \"type\" : {\n                        \"coding\" : [\n                          {\n                            \"system\": \"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                            \"code\" : \"ACSN\"\n                          }\n                        ]\n                      },\n                      \"system\" : \"urn:oid:2.16.840.1.113883.19.5\",\n                      \"value\" : \"GH339884\",\n                      \"assigner\" : {\n                        \"reference\" : \"Organization/a92ac1be-fb34-49c1-be58-10928bd271cc\",\n                        \"display\" : \"My Healthcare Provider\"\n                      }\n                    }\n                  }\n                ]\n              }\n            },\n            {\n              \"key\": \"patient\",\n              \"resource\": {\n                \"resourceType\": \"Patient\",\n                \"id\": \"503824b8-fe8c-4227-b061-7181ba6c3926\",\n                \"identifier\" : [\n                  {\n                    \"use\" : \"official\",\n                    \"type\" : {\n                      \"coding\" : [\n                        {\n                          \"system\" : \"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                          \"code\" : \"MR\"\n                        }\n                      ]\n                    },\n                    \"system\": \"urn:oid:2.16.840.1.113883.19.5\",\n                    \"value\": \"4438001\",\n                    \"assigner\": {\n                      \"reference\": \"Organization/a92ac1be-fb34-49c1-be58-10928bd271cc\",\n                      \"display\": \"My Healthcare Provider\"\n                    }\n                  }\n                ],\n                \"name\" : [\n                  {\n                    \"use\" : \"official\",\n                    \"family\" : \"Smith\",\n                    \"given\" : [\n                      \"John\"\n                    ],\n                    \"prefix\" : [\n                      \"Dr.\"\n                    ],\n                    \"suffix\" : [\n                      \"Jr.\",\n                      \"M.D.\"\n                    ]\n                  }\n                ],\n                \"gender\" : \"male\",\n                \"birthDate\" : \"1978-11-03\"\n              }\n            }\n          ]\n        }\n      }\n  },\n  {\n    label: \"[RAD-149] DiagnoticReport-close\",\n    value: \"[RAD-149] DiagnoticReport-close\",\n    eventObject: \n    {\n      \"timestamp\": \"\",\n      \"id\": \"\",\n      \"event\": {\n        \"hub.topic\": \"\",\n        \"hub.event\": \"diagnosticreport-close\",\n        \"context\": [\n          {\n            \"key\": \"report\",\n            \"resource\": {\n              \"resourceType\": \"DiagnosticReport\",\n              \"id\": \"2402d3bd-e988-414b-b7f2-4322e86c9327\",\n              \"identifier\" : [\n                {\n                  \"use\" : \"official\",\n                  \"system\" : \"http://myhealthcare.com/reporting-system\",\n                  \"value\" : \"GH339884.RPT.0001\"\n                }\n              ],\n              \"status\": \"unknown\",\n              \"basedOn\" : [\n                {\n                  \"type\" : \"ServiceRequest\",\n                  \"identifier\" : {\n                    \"type\" : {\n                      \"coding\" : [\n                        {\n                          \"system\" : \"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                          \"code\" : \"ACSN\"\n                        }\n                      ]\n                    },\n                    \"system\" : \"urn:oid:2.16.840.1.113883.19.5\",\n                    \"value\" : \"GH339884\",\n                    \"assigner\" : {\n                      \"reference\" : \"Organization/a92ac1be-fb34-49c1-be58-10928bd271cc\",\n                      \"display\" : \"My Healthcare Provider\"\n                    }\n                  }\n                }\n              ],\n              \"code\" : {\n                \"coding\" : [\n                  {\n                    \"system\" : \"http://loinc.org\",\n                    \"code\" : \"19005-8\",\n                    \"display\": \"Radiology Imaging study [Impression] (narrative)\"\n                  }\n                ]\n              },\n              \"subject\": {\n                \"reference\": \"Patient/503824b8-fe8c-4227-b061-7181ba6c3926\"\n              },\n              \"imagingStudy\": [\n                {\n                  \"reference\": \"ImagingStudy/e25c1d31-20a2-41f8-8d85-fe2fdeac74fd\"\n                }\n              ]\n            }\n          },\n          {\n            \"key\": \"study\",\n            \"resource\": {\n              \"resourceType\": \"ImagingStudy\",\n              \"id\": \"e25c1d31-20a2-41f8-8d85-fe2fdeac74fd\",\n              \"identifier\": [\n                {\n                  \"system\" : \"urn:dicom:uid\",\n                  \"value\" : \"urn:oid:1.2.840.83474.8.231.875.3.15.661594731\"\n                }\n              ],\n              \"status\": \"unknown\",\n              \"subject\": {\n                \"reference\": \"Patient/503824b8-fe8c-4227-b061-7181ba6c3926\"\n              },\n              \"basedOn\" : [\n                {\n                  \"type\" : \"ServiceRequest\",\n                  \"identifier\" : {\n                    \"type\" : {\n                      \"coding\" : [\n                        {\n                          \"system\": \"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                          \"code\" : \"ACSN\"\n                        }\n                      ]\n                    },\n                    \"system\" : \"urn:oid:2.16.840.1.113883.19.5\",\n                    \"value\" : \"GH339884\",\n                    \"assigner\" : {\n                      \"reference\" : \"Organization/a92ac1be-fb34-49c1-be58-10928bd271cc\",\n                      \"display\" : \"My Healthcare Provider\"\n                    }\n                  }\n                }\n              ]\n            }\n          },\n          {\n            \"key\": \"patient\",\n            \"resource\": {\n              \"resourceType\": \"Patient\",\n              \"id\": \"503824b8-fe8c-4227-b061-7181ba6c3926\",\n              \"identifier\" : [\n                {\n                  \"use\" : \"official\",\n                  \"type\" : {\n                    \"coding\" : [\n                      {\n                        \"system\" : \"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                        \"code\" : \"MR\"\n                      }\n                    ]\n                  },\n                  \"system\": \"urn:oid:2.16.840.1.113883.19.5\",\n                  \"value\": \"4438001\",\n                  \"assigner\": {\n                    \"reference\": \"Organization/a92ac1be-fb34-49c1-be58-10928bd271cc\",\n                    \"display\": \"My Healthcare Provider\"\n                  }\n                }\n              ]\n            }\n          }\n        ]\n      }\n    }\n  },\n  {\n    label: \"[RAD-150] DiagnoticReport-update\",\n    value: \"[RAD-150] DiagnoticReport-update\",\n    eventObject: \n    {\n      \"timestamp\": \"\",\n      \"id\": \"\",\n      \"event\": {\n        \"hub.topic\": \"\",\n        \"hub.event\": \"DiagnosticReport-update\",\n        \"context.versionId\": \"\",\n        \"context\": [\n          {\n            \"key\": \"report\",\n            \"resource\": {\n              \"resourceType\": \"DiagnosticReport\",\n              \"id\": \"2402d3bd-e988-414b-b7f2-4322e86c9327\",\n              \"status\": \"unknown\",\n              \"code\" : {\n                \"coding\" : [\n                  {\n                    \"system\" : \"http://loinc.org\",\n                    \"code\" : \"19005-8\",\n                    \"display\": \"Radiology Imaging study [Impression] (narrative)\"\n                  }\n                ]\n              }\n            }\n          },\n          {\n            \"key\": \"updates\",\n            \"resource\": {\n              \"resourceType\": \"Bundle\",\n              \"type\": \"transaction\",\n              \"entry\": [\n                {\n                  \"request\": {\n                    \"method\": \"PUT\"\n                  },\n                  \"resource\": {\n                    \"resourceType\": \"ImagingStudy\",\n                    \"description\": \"CHEST XRAY\",\n                    \"started\": \"2010-02-14T01:10:00.000Z\",\n                    \"id\": \"7e9deb91-0017-4690-aebd-951cef34aba4\",\n                    \"identifier\": [\n                      {\n                        \"type\": {\n                          \"coding\": [\n                            {\n                              \"system\": \"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                              \"code\": \"ACSN\"\n                            }\n                          ]\n                        },\n                        \"value\": \"3478116342\"\n                      },\n                      {\n                        \"system\": \"urn:dicom:uid\",\n                        \"value\": \"urn:oid:2.16.124.113543.6003.1154777499.30276.83661.3632298176\"\n                      }\n                    ]\n                  }\n                },\n                {\n                  \"request\": {\n                    \"method\": \"PUT\"\n                  },\n                  \"resource\": {\n                    \"resourceType\": \"Observation\",\n                    \"id\": \"40afe766-3628-4ded-b5bd-925727c013b3\",\n                    \"partOf\": {\n                      \"reference\": \"ImagingStudy/7e9deb91-0017-4690-aebd-951cef34aba4\"\n                    },\n                    \"status\": \"preliminary\",\n                    \"category\": {\n                      \"system\": \"http://terminology.hl7.org/CodeSystem/observation-category\",\n                      \"code\": \"imaging\",\n                      \"display\": \"Imaging\"\n                    },\n                    \"code\": {\n                      \"coding\": [\n                        {\n                          \"system\": \"http://www.radlex.org\",\n                          \"code\": \"RID49690\",\n                          \"display\": \"simple cyst\"\n                        }\n                      ] \n                    },\n                    \"issued\": \"2020-09-07T15:02:03.651Z\"\n                  }\n                }\n              ]\n            }\n          }\n        ]\n      }\n    }\n  },\n  {\n    label: \"[RAD-151] DiagnoticReport-select\",\n    value: \"[RAD-151] DiagnoticReport-select\",\n    eventObject: \n    {\n      \"timestamp\": \"\",\n      \"id\": \"\",\n      \"event\": {\n        \"hub.topic\": \"\",\n        \"hub.event\": \"DiagnosticReport-select\",\n        \"context\": [\n          {\n            \"key\": \"report\",\n            \"resource\": {\n              \"resourceType\": \"DiagnosticReport\",\n              \"id\": \"2402d3bd-e988-414b-b7f2-4322e86c9327\",\n              \"status\": \"unknown\",\n              \"code\" : {\n                \"coding\" : [\n                  {\n                    \"system\" : \"http://loinc.org\",\n                    \"code\" : \"19005-8\",\n                    \"display\": \"Radiology Imaging study [Impression] (narrative)\"\n                  }\n                ]\n              }\n            }\n          },\n          {\n            \"key\": \"select\",\n            \"resources\": [\n              {\n                \"resourceType\": \"Observation\",\n                \"id\": \"40afe766-3628-4ded-b5bd-925727c013b3\"\n              }\n            ]\n          }\n        ]\n      }\n    }\n  },\n  {\n    label: \"[RAD-156] sync-error\",\n    value: \"[RAD-156] sync-error\",\n    eventObject:\n    {\n      \"timestamp\": \"\",\n      \"id\": \"\",\n      \"event\": {\n        \"hub.topic\": \"\",\n        \"hub.event\": \"syncerror\",\n        \"context\": [\n          {\n            \"key\": \"operationoutcome\",\n            \"resource\": {\n              \"resourceType\": \"OperationOutcome\",\n              \"issue\": [\n                {\n                  \"severity\": \"warning\",\n                  \"code\": \"processing\",\n                  \"diagnostics\": \"Acme Product failed to follow context\",\n                  \"details\": {\n                    \"coding\": [\n                      {\n                        \"system\": \"https://fhircast.hl7.org/events/syncerror/eventid\",\n                        \"code\": \"fdb2f928-5546-4f52-87a0-0648e9ded065\"\n                      },\n                      {\n                        \"system\": \"https://fhircast.hl7.org/events/syncerror/eventname\",\n                        \"code\": \"Patient-open\"\n                      },\n                      {\n                        \"system\": \"https://fhircast.hl7.org/events/syncerror/subscriber\",\n                        \"code\": \"Acme Product\"\n                      },\n                      {\n                        \"system\": \"http://example.com/events/syncerror/your-error-code-system\",\n                        \"code\": \"FHIRcast sync error\"\n                      }\n                    ]\n                  }\n                }\n              ]\n            }\n          }\n        ]\n      }\n    }\n  },\n  \n\n  ];\n  \n  export default testData;","import React, { useState, useEffect } from 'react';\nimport { ServicesManager, CommandsManager} from '@ohif/core';\nimport  { Button, ButtonEnums,Label,Select,InputText,Checkbox } from '@ohif/ui'\nimport testData from './fhircastTestData'\nimport { useAppConfig } from '@state';\n\nfunction FhircastPanel({\n  servicesManager,\n  commandsManager,\n  extensionManager,\n}): React.FunctionComponent { \n \n\n  const {FhircastService}=servicesManager.services;\n  const [hubConnected, sethubConnected] = useState(false); \n  const [tokenAcquired, setTokenAcquired] = useState(false);\n  const [topic,setTopic]=useState('Session-DrXray');\n  const [publishEvent,setPublishEvent]=useState({label:'ImagingStudy-open',value: 'ImagingStudy-open'});\n  const [selectedHub,setSelectedHub]=useState({value:'TEST',label:'TEST-FHIRcast Javascript Sandbox'});  \n\n  const [overwriteDataCheckbox,setOverwriteDataCheckbox]=useState(true);\n  const [patientOpenCheckbox,setPatientOpenCheckbox]=useState(true);\n  const [patientCloseCheckbox,setPatientCloseCheckbox]=useState(true);\n\n  const [appConfig] =useAppConfig();\n \n  let hub={\n    name:'',\n    friendlyName:'',\n    productName :'',\n    enabled:false,\n    events: [],\n    lease:999,\n    hub_endpoint: '',\n    authorization_endpoint: '',\n    token_endpoint: '',\n    token:'',\n    subscribed:false,\n    subscriberName:''\n  };\n\n\n  function getHubOptions(){   // used to fill the hub select drop down\n    var options=[];\n    if (appConfig.fhircast.hubs) {\n      appConfig.fhircast.hubs.forEach(hub =>\n      {\n        if (hub.enabled) {\n          options.push({label:hub.name+'-'+hub.friendlyName,value:hub.name});\n        }\n      })\n    }\n    return options;\n  }\n\n  \n  const getTokenClick= async() => {\n    console.debug('FhircastPanel: Getting token from the  hub: ' + FhircastService.getHub().name); \n    var succeeded= await FhircastService.getToken();\n    if (succeeded) {\n      setTokenAcquired(true);\n      if (FhircastService.getHub.subscribed) {sethubConnected(true);}\n    }\n  }\n\n  useEffect(() => {\n    hub=FhircastService.getHub();\n    if (hub.subscribed)  {sethubConnected(true); }\n    if (hub.token != '') {setTokenAcquired(true); }\n    setSelectedHub({label: hub.name,value:hub.friendlyName });\n    // ~~ Subscription\n    const fhircastEvent = FhircastService.EVENTS.FHIRCAST_MESSAGE;\n    const hubSubscribed= FhircastService.EVENTS.HUB_SUBSCRIBED;\n    const hubUnsubscribed= FhircastService.EVENTS.HUB_UNSUBSCRIBED;\n    const websocketClose = FhircastService.EVENTS.WEBSOCKET_CLOSE;\n    const subscriptions = [];\n\n    [fhircastEvent, hubSubscribed, hubUnsubscribed,websocketClose,].forEach(evt => {\n      const { unsubscribe } = FhircastService.subscribe(evt, () => {      \n        if ( evt==='tokenAcquired' ) {\n          setTokenAcquired(true);\n          console.debug('FhircastPanel: tokenAcquired event received.');\n        }\n        if (evt==='hubSubscribed') {\n          sethubConnected(true);\n          console.debug('FhircastPanel: hubSubscribed event received.');\n        }\n        if (evt==='hubUnsubscribed'  ) {\n          sethubConnected(false);\n          console.debug('FhircastPanel: hubUnsubscribed event received.');\n        }\n        if ( evt==='websocketClose' ) {\n          sethubConnected(false);\n          console.debug('FhircastPanel: websocketClose event received.');\n        }\n        if (evt==='fhircastMessage') {\n          console.debug('FhircastPanel: fhircastMessage event received.');\n        }\n      });\n      subscriptions.push(unsubscribe);\n    });\n    return () => {\n      subscriptions.forEach(unsub => {\n        unsub();\n      });\n    };\n  },[]);\n\n  const subscribeClick= async() => {\n    console.debug('FhircastPanel: Subscribing to the hub.');\n    if (FhircastService.getTopic() === undefined) {\n      FhircastService.setTopic(topic);\n    }\n    var response= await FhircastService.fhircastSubscribe();\n    if (response==202) {\n      sethubConnected(true);\n    }\n  }\n\n  const unsubscribeClick= async() => {\n    console.debug('FhircastPanel: Unsubscribing from the hub.');\n    var response= await FhircastService.fhircastUnsubscribe();\n    if (response==202) {\n      sethubConnected(false);\n    } else {\n      sethubConnected(false);\n    }\n  }\n\n  const publishClick= async() => {\n    try {\n        console.debug('FhircastPanel: calling publish');\n        var eventObj=testData.filter(e=>e.label===publishEvent.label);\n        if (overwriteDataCheckbox && eventObj[0].eventObject.event['hub.event'].toLowerCase()==='imagingstudy-open') {\n          console.debug('FhircastPanel: Publishing ImagingStudy event from current active display port.');\n          const { viewportGridService, displaySetService, cornerstoneViewportService } = servicesManager.services;\n          const displaySets = displaySetService.getActiveDisplaySets();\n          const displaySet = displaySets[0];\n          const instance = displaySet?.instances?.[0] || displaySet?.instance;\n          if (instance) {\n            console.debug('FhircastPanel: Publishing ImagingStudy '+ instance.StudyInstanceUID);\n            eventObj[0].eventObject.event.context[1].resource.uid='urn:oid:'+instance.StudyInstanceUID;\n          }\n        }\n        var response=await FhircastService.fhircastPublish(eventObj[0].eventObject,); \n        console.debug('FhircastPanel: publish response: ',response.statusText);\n      }\n      catch (err) {\n        console.warn('FhircastPanel: publish error: ',err.message);\n      }\n  }\n\n  \n\n  const getContextClick= async() => {\n    console.debug('FhircastPanel: Fetching current context from the hub.');\n    try {\n      var response=await FhircastService.fhircastGetContext(); \n      console.debug('FhircastPanel: Get Context response: ',JSON.stringify(response));\n      alert(JSON.stringify(response));\n    } catch(err) {\n      console.warn('FhircastPanel: Get Context error ',err.message);\n    }\n  }\n\n  const handleChange=()=>{}\n  \n  const patientOpenCheckboxClick =()=>{\n    setPatientOpenCheckbox(!patientOpenCheckbox);\n  }\n  const patientCloseCheckboxClick =()=>{\n    setPatientCloseCheckbox(!patientCloseCheckbox);\n  }\n  const overwriteDataCheckboxClick =()=>{\n    setOverwriteDataCheckbox(!overwriteDataCheckbox);\n  }\n  const changeHub=(selected)=>{\n    setSelectedHub(selected);\n    sethubConnected(false);\n    setTokenAcquired(false);\n    FhircastService.setHub(selected.value);\n  }\n  return (\n    <>\n      <div className=\"bg-secondary-main flex justify-between px-2 py-1\">\n        <span className=\"text-base center font-bold uppercase tracking-widest text-white\">FHIRcast</span>     \n      </div>\n      <div className=\"ohif-scrollbar  overflow-y-auto overflow-x-hidden text-primary-light  text-base\"> \n      <hr/>\n      <label className=\"leading-[1.2] text-[12px]\">Hub status: </label> \n      {hubConnected && <label className=\" leading-[1.2] text-white\">SUBSCRIBED</label>}\n      {!hubConnected && <label className=\" leading-[1.2] text-white\">NOT SUBSCRIBED</label>}       \n      <br/>\n      <Select \n        id='hub'\n        options={getHubOptions()}\n        value={selectedHub}\n        onChange={value => changeHub(value)}\n        />\n      <Button \n        type={ButtonEnums.type.secondary}\n        disabled={false}\n        onClick= {getTokenClick}\n        size='small'\n        >Get token\n      </Button>\n      <br/><hr/>\n      <Label className=\" leading-[1.2] text-primary-light \" >Subscribe to a topic:\n        <InputText \n          label=''\n          id='topic' \n          disabled={hubConnected || !tokenAcquired}\n          value={topic}\n          onChange={newValue=> {  \n              setTopic(newValue); \n              FhircastService.setTopic(newValue);\n              }}>\n        </InputText>\n      </Label>\n      <br/>\n      <Button \n        type={ButtonEnums.type.secondary}\n        disabled={hubConnected || !tokenAcquired}\n        onClick= {subscribeClick}\n        size='small'\n        >Subscribe\n      </Button>\n      <Button \n        type={ButtonEnums.type.secondary}\n        disabled={!hubConnected || !tokenAcquired}\n        onClick= {unsubscribeClick}\n        size='small'\n        >Unsubscribe\n      </Button>\n      <br/><hr/>\n      <Button \n      type={ButtonEnums.type.secondary}\n      disabled={!tokenAcquired}\n      onClick= {getContextClick}\n      size='small'    \n      >Get context\n      </Button>\n      <label>Auto-load context:\n        <input type='checkbox' checked={!patientOpenCheckbox} onChange={patientOpenCheckboxClick}/>    \n      </label>\n      <br/><hr/>\n      <p>Publish an event:</p>\n      <Select \n        id='eventSelect'\n        options={testData}\n        value={publishEvent}\n        onChange={value => {setPublishEvent({label: value.value});}}\n        defaultValue=  {{label:'ImagingStudy-open',value: 'ImagingStudy-open'}}\n      />    \n      <Button \n        type={ButtonEnums.type.secondary}\n        disabled={!tokenAcquired}\n        onClick= {publishClick}\n        size='small'  \n      >Publish\n      </Button>\n      <label>Overwrite test data:\n        <input type='checkbox' checked={overwriteDataCheckbox} onChange={overwriteDataCheckboxClick}/>    \n      </label>\n      <br/><hr/>\n      <p>Handle events from this hub:</p>\n\n       <br/>\n      <label>Patient-open:\n        <input type='checkbox' checked={patientOpenCheckbox} onChange={patientOpenCheckboxClick}/>    \n      </label><br/>\n      <label>Patient-close:\n        <input type='checkbox' checked={patientCloseCheckbox} onChange={patientCloseCheckboxClick}/>    \n      </label><br/>\n      <label>ImagingStudy-open:\n        <input type='checkbox' checked={patientOpenCheckbox} onChange={patientOpenCheckboxClick}/>    \n      </label><br/>\n      <label>ImagingStudy-close:\n        <input type='checkbox' checked={patientOpenCheckbox} onChange={patientOpenCheckboxClick}/>    \n      </label><br/>\n      <label>DiagnosticReport-open:\n        <input type='checkbox' checked={patientOpenCheckbox} onChange={patientOpenCheckboxClick}/>    \n      </label><br/>\n      <label>DiagnosticReport-close:\n        <input type='checkbox' checked={patientOpenCheckbox} onChange={patientOpenCheckboxClick}/>       \n      </label><br/>\n      <br/><hr/>\n      <p>Send events to this hub:</p>\n      <br/>\n      <label>ImagingStudy-open:\n        <input type='checkbox' checked={patientOpenCheckbox} onChange={patientOpenCheckboxClick}/>    \n      </label><br/>\n      <label>ImagingStudy-close:\n        <input type='checkbox' checked={patientOpenCheckbox} onChange={patientOpenCheckboxClick}/>    \n      </label><br/>\n\n    </div>\n    </>\n  );\n\n}\n\nexport default FhircastPanel;\n","import React, { useState, useEffect } from 'react';\nimport { ServicesManager, ExtensionManager, CommandsManager, DicomMetadataStore } from '@ohif/core';\nimport  { Button, ButtonEnums,Label,Select,InputText } from '@ohif/ui'\nimport {powercastGetConfiguration} from './powercast'\nimport { useAppConfig } from '@state';\n\nfunction PowercastPanel(){ \n\n  const [configuration, setconfiguration] = useState('');\n  const [authorization, setWauthorization] = useState('');\n  const [appConfig] =useAppConfig();\n\n    const getConfigurationClick= async() => {\n        console.debug('Powercast: Get topic and configuration.');\n        try {\n          var response=await powercastGetConfiguration(appConfig.powercastConnector[0].connector_config_endpoint); \n          console.debug('PowerCast: Get configuration response: ',JSON.stringify(response));\n          setconfiguration(JSON.stringify(response));\n        } catch(err) {     \n          console.debug('PowerCast: Get configuration error: ',err.message);\n          setconfiguration(err.message);\n        }\n    }\n\n\n    const getAuthorizationClick= async() => {\n        console.debug('Powercast: Getting auth.');\n        try {\n   //       const myhub=getHub();\n     //     var response=await powercastGetContext(myhub,topic); \n     //     console.debug('FHIRcast: Get Context response: ',JSON.stringify(response));\n            // setconfiguration(JSON.stringify(response));\n            setconfiguration('\"authorization_endpoint\": \"https://nuance-auth0-server/oauth/authorize\"');\n   //       alert(JSON.stringify(response));\n        } catch(err) {\n          \n  \n        }\n    }\n\n    return (\n    <>\n      <div className=\"ohif-scrollbar  overflow-y-auto overflow-x-hidden text-primary-light  text-base\"> \n      <Button \n        type={ButtonEnums.type.secondary}\n        onClick= {getConfigurationClick}\n        size='small'\n        >Get configuration\n      </Button>\n      <textarea className=\"text-[10px] text-black\"\n        id='configuration' \n        readOnly\n        value={configuration}  \n        rows={6} \n        cols={40} \n      />\n      <br/><hr/>\n      <Button \n        type={ButtonEnums.type.secondary}\n        onClick= {getAuthorizationClick}\n        size='small'    \n        >Get Authorization\n      </Button>\n      <textarea className=\"text-[10px] text-black\"\n        id='authorization' \n        readOnly\n        value={authorization}  \n        rows={6} \n        cols={40} \n        />\n        </div>\n    </>\n  );\n}\n\nexport default PowercastPanel;","\nexport async function powercastGetConfiguration(connector_endpoint) {\n    const requestOptions = {\n        method: 'GET',\n        headers: { 'Content-Type': 'application/json' },\n    };\n    try {\n        const response = await fetch(connector_endpoint,requestOptions);\n        if (response.status==200) {\n            const config= await response.json();\n            return(config); \n        }\n    }\n    catch(err) {\n        console.debug('PowerCast: Error getting configuration.', err.message);\n    }\n}\nexport async function powercastGetToken(hub ,topic, eventCallback) {\n    const endpoint='1231234414';\n   // Create a URL object with the current location\n    const urlObj = new URL(window.location.origin + window.location.pathname + location.search+'/fhircastCallback');\n    console.debug(URL.url);\n    var formData  ='hub.callback=http://localhost:3000/fhircastCallback';\n    formData +='&hub.mode=subscribe' ;\n    formData +='&hub.events='   +hub.events;\n    formData +='&hub.secret='   +hub.secret;\n    formData +='&hub.topic=' + topic   ;\n    formData +='&hub.lease='    +hub.lease;\n    formData +='&hub.channel.type=websocket';\n    formData +='&hub.channel.endpoint='+endpoint;\n    const requestOptions = {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n        body: formData\n    };\n    try {\n        const response = await fetch(hub.url,requestOptions);\n        if (response.status==202) {\n            console.debug('FHIRcast: Subscription accepted by hub. opening websocket.');\n            //  open websocket\n            var protocol='ws:';\n            const url= new URL(hub.url);\n            if (hub.url.includes('https:')) { protocol='wss:';}\n            const wsEvents = new WebSocket(protocol+'//' + url.host + '/bind/'+endpoint);\n            wsEvents.onopen = function () {\n                console.debug('FHIRcast: websocket is connected.');\n                //wsEvents.send('bind:'+hubs[0].endpoint);  ?? Nuance wants the endpoint back after connection I think      \n            }       \n            wsEvents.onmessage = function (ev) {\n                console.debug('FHIRcast: websocket received data.');\n                eventCallback(ev.data);\n            }\n            wsEvents.onclose = function () {\n                console.debug('FHIRcast: websocket is closed.');\n                // set status of hub to disconnected here\n            }\n            var subscribedHub=new fhircastHubClass();\n            subscribedHub.url=hub.url;\n            subscribedHub.topic=topic;\n            subscribedHub.name=hub.name;\n            subscribedHub.status=\"connected\";\n            return subscribedHub;\n        }\n        else {\n            console.debug('FHIRcast: Subscription rejected by hub:',response.status);\n        }\n    }\n    catch(err) {\n        console.debug('FHIRcast: Error subscribing to the hub.', err.message);\n    }\n}","\nimport React from 'react';\nimport { CustomizationService } from '@ohif/core';\nimport { ServicesManager, CommandsManager, ExtensionManager } from '@ohif/core';\n\nexport function CallbackCheck() {\n  console.debug('FHIRcast:  callback called'); \n  return('{hub.topic=\"Session-DrXray\",hub.challenge=\"secret\"}'); \n\n  //'{hub.topic=\"Session-DrXray\",hub.chalenge=\"secret\"}',\n} \n\n\nexport default function getCustomizationModule({ servicesManager, extensionManager }) {\n  return [\n    {\n      name: 'fhircastCallback',\n      value: {\n        id: 'customRoutes',\n        routes: [\n          {\n            path: '/fhircastCallback',\n            children: () => <CallbackCheck/>,\n             // console.debug('FHIRcast:  callback called');\n            // return('{hub.topic=\"Session-DrXray\",hub.chalenge=\"secret\"}'); //'{hub.topic=\"Session-DrXray\",hub.chalenge=\"secret\"}',     \n          },\n        ],\n      },\n    },\n\n  ]\n}\n","/*\nFhircastService\n\n  public async fhircastPublish(fhircastMessage) -returns response.status\n  public async fhircastGetContext() = returns context object\n\n  processEvent\n\n  public async getToken() \n  public async fhircastSubscribe() \n  public async fhircastUnsubscribe() \n\n  public setHub(hubName: string) : boolean\n  public getHub() : returns the hub object if set.\n  public setTopic(topic: string) \n  public getTopic(topic: string) :string\n \n*/\nimport { PubSubService, ServicesManager,CommandsManager ,ExtensionManager} from '@ohif/core';\n\nconst EVENTS = {\n  FHIRCAST_MESSAGE: 'fhircastMessage',\n  HUB_SUBSCRIBED: 'hubSubscribed',\n  HUB_UNSUBSCRIBED: 'hubUnsubscribed',\n  WEBSOCKET_CLOSE: 'websocketClose',\n  TOKEN_ACQUIRED: 'tokenAcquired',\n  STUDY_CLOSE: 'studyClose',\n};\n\nclass FhircastService extends PubSubService {\n  private _extensionManager: ExtensionManager;\n  private _servicesManager: ServicesManager;\n  private _commandsManager: CommandsManager;\n // private _resubscribe: boolean;\n\n  public static readonly EVENTS = EVENTS;\n\n  public static REGISTRATION = {\n    name: 'fhircastService',\n    altName: 'FhircastService',\n    create: ({ extensionManager, commandsManager, servicesManager}) => {\n      return new FhircastService(extensionManager, commandsManager, servicesManager);\n    },\n  };\n  \n  public hub={\n    name: '',\n    friendlyName: '',\n    productName : '',\n    enabled: false,\n    events: [],\n    lease:999,\n    hub_endpoint: '',\n    authorization_endpoint: '',\n    token_endpoint: '',\n    token:'',\n    subscriberName:'',\n    topic: '',\n    lastPublishedMessageID: '',  // to filter event echo\n    subscribed:false,\n    resubscribeRequested: false,\n    websocket: null \n  };\n\n  private readonly fhircastConfig=window.config.fhircast;\n  \n  constructor(\n    extensionManager: ExtensionManager,\n    commandsManager: CommandsManager,\n    servicesManager: ServicesManager\n  ) {\n    console.debug('FhircastService: creating service '  );\n    super(EVENTS);\n    this._extensionManager = extensionManager;\n    this._commandsManager = commandsManager;\n    this._servicesManager = servicesManager;\n    if (this.fhircastConfig.defaultHub){   \n      const result=this.setHub(this.fhircastConfig.defaultHub);  \n      if (this.fhircastConfig.autoStart) { this.getToken(); } \n    }   \n    const interval = setInterval(()=> {this.checkWebsocket(interval);},10000);\n  }\n \n  private checkWebsocket= async(interval) => {  // resubscribe every 10secs if the websocket disconnects\n    //console.debug('FhircastService: checking websocket '  );\n    //if (this.hub.websocket) { this.hub.websocket.pong();}\n    if ( this.hub.resubscribeRequested && this.hub.subscribed) {\n      console.debug('FhircastService: Try to resubscribe '  );\n      this.hub.resubscribeRequested=false;\n      var response= await this.fhircastSubscribe();\n      if (response==202) {\n        this.hub.resubscribeRequested=false;\n      } else {\n        this.hub.resubscribeRequested=true; \n      }\n    }\n    else if (!this.hub.subscribed && this.hub.resubscribeRequested) {\n      this.hub.resubscribeRequested=false;\n    }\n  }\n\n  public createImagingStudyClose(StudyUID:string){\n    var message={\n      timestamp: '',\n      id: '',\n      event: {\n        'hub.topic': '',\n        'hub.event': 'imagingstudy-close',\n        context: []\n      }\n    }\n    return(message);\n  }\n\n\n  public createImagingStudyOpen(StudyUID:string){\n    var message={\n    timestamp: '',\n    id: '',\n    event: {\n      'hub.topic': '',\n      'hub.event': 'imagingstudy-open',\n      context: [\n        {\n          key: \"patient\",\n          resource: {\n            resourceType: 'Patient',\n            id: 'ewUbXT9RWEbSj5wPEdgRaBw3',\n            identifier: [\n              {\n                system: 'urn:oid:1.2.840.114350',\n                value: '185444'\n              },\n              {\n                system: 'urn:oid:1.2.840.114350.1.13.861.1.7.5.737384.27000',\n                value: '2667'\n              }\n            ]\n          }\n        },\n        {\n          key: 'study',\n          resource: {\n            resourceType: 'ImagingStudy',\n            id: '8i7tbu6fby5ftfbku6fniuf',\n            uid: 'urn:oid:' + StudyUID ,\n            identifier: [\n              {\n                system: '7678',\n                value: '185444'\n              }\n            ],\n            patient: {\n              reference: 'Patient/ewUbXT9RWEbSj5wPEdgRaBw3'\n            }\n          }\n        }\n      ]   \n    }\n    \n    }\n    return(message);\n  }\n\n  public setHub(hubName: string) : boolean {\n    if (hubName===this.hub.name) {\n      console.debug('FhircastService: setHub: hub already set to ' + hubName );\n      return(true);\n    }  \n    console.debug('FhircastService: setting hub to ' + hubName );\n    try {\n      if (this.fhircastConfig.hubs) {\n        this.fhircastConfig.hubs.forEach(hubconfig =>{\n          if (hubconfig.enabled && hubconfig.name===hubName) {\n            this.hub=hubconfig;\n            this.hub.subscribed=false;\n            return(true);\n          }\n        });\n      } \n      else {\n        console.debug('FhircastService: hub not found in configuration ' + hubName );\n        return(false);\n      }\n    } catch(err) {\n      console.warn('FhircastService: Unable to set the hub to  ' + hubName );\n      return(false);\n    }  \n  }\n  \n  public getHub() {\n    console.debug('FhircastService: getHub: hub is ' + this.hub.name );\n    return(this.hub) ;\n  }\n\n  public getTopic(topic: string) :string {\n    console.debug('FhircastService: getTopic called.'  );\n    return(this.hub.topic);\n  }\n\n  public setTopic(topic: string)  {\n    console.debug('FhircastService: setting topic to ' +topic );\n    this.hub.topic=topic;\n    this.hub.subscriberName='OHIF-'+topic+'-'+Math.random().toString(36).substring(2, 16);\n  }\n\n  public async getToken()  {\n    console.debug('FhircastService: Getting token.');\n    const tokenFormData= new URLSearchParams();  \n    tokenFormData.append('grant_type','client_credentials');\n    tokenFormData.append('client_id',process.env.REACT_APP_FHIRCAST_CLIENT_ID);\n    tokenFormData.append('client_secret',process.env.REACT_APP_FHIRCAST_CLIENT_SECRET);\n    const requestOptions = {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n        body: tokenFormData\n    };\n    try {\n      const response = await fetch(this.hub.token_endpoint,requestOptions);\n      if (response.status==200) {\n          const config= await response.json();\n          if (config.access_token) {\n              console.debug('FhircastService:  Token received: ',config.access_token);\n              this.hub.token=config.access_token\n              this._broadcastEvent(FhircastService.EVENTS.TOKEN_ACQUIRED,{})\n          }\n          if (config.topic) {\n            console.debug('FhircastService:  Topic received: ',config.topic);\n            this.setTopic(config.topic);\n            if (this.fhircastConfig.autoStart) { \n              this.fhircastSubscribe(); \n            } \n          }\n          return(true); \n      }\n      else {\n        console.debug('FhircastService: Error getting token.');\n        return(false);         \n      }\n    }\n    catch(err) {\n        console.warn('FhircastService: Error getting token:', err.message);\n        return(false);\n    }\n  }\n\n  public async fhircastUnsubscribe() {\n    this.hub.subscribed=false;\n    this.hub.resubscribeRequested=false;\n    const subscribeFormData= new URLSearchParams();  \n    subscribeFormData.append('hub.mode', 'unsubscribe');\n    subscribeFormData.append('hub.channel.type','websocket');\n    subscribeFormData.append('hub.callback',window.location.origin +'/fhircastCallback');\n    subscribeFormData.append('hub.events',this.hub.events.toString());\n    subscribeFormData.append('hub.topic',this.hub.topic);\n    subscribeFormData.append('hub.lease',this.hub.lease.toString());\n    subscribeFormData.append('subscriber.name',this.hub.subscriberName);\n    const requestOptions = {\n        method: 'POST',\n        headers: {  'Content-Type': 'application/x-www-form-urlencoded',\n                    'Authorization': 'Bearer ' +this.hub.token\n                },\n        body: subscribeFormData,\n        signal: AbortSignal.timeout(5000)\n    };\n    try {\n        const response = await fetch(this.hub.hub_endpoint,requestOptions);\n        if (response.status==202) {    \n          const subscriptionResponse=await response.json();\n          console.debug('FhircastService: Unsubscribe successfully. ');  \n          this._broadcastEvent(FhircastService.EVENTS.HUB_UNSUBSCRIBED,{});     \n        }\n        else {\n          console.debug('FhircastService: Unsubscribe refused by the hub. ');  \n        }\n      }\n      catch(err) {\n        console.warn('FhircastService: Error unsubscribing from the hub.', err.message);\n      }\n      this.hub.websocket.close();\n  }\n\n  private processEvent(eventData) {\n    try {           \n      const fhirMessage=JSON.parse(eventData);\n      if (fhirMessage['hub.mode']) {\n        console.debug('FhircastService: Subscription acknowledged on the websocket.');             \n      }\n      if (fhirMessage.event) {                    \n        if (fhirMessage.event['hub.event']==='heartbeat') {\n          console.debug('FhircastService: Received websocket heartbeat from hub.');\n        }\n        else if (fhirMessage.id===this.hub.lastPublishedMessageID) {\n          console.debug('FhircastService: Received echo of event '+fhirMessage.event['hub.event']+', id:'+fhirMessage.id);       \n        } \n        else if (fhirMessage.event) \n        {            \n          console.debug('FhircastService: websocket received data: ',eventData);  \n          this._broadcastEvent(FhircastService.EVENTS.FHIRCAST_MESSAGE,{}); \n          let currentLocation=window.location.search; \n\n          console.debug('FhircastService: wcurrent location: ',currentLocation);                             \n          if ( fhirMessage.event['hub.event'].toLowerCase()==='patient-open') {\n            if (fhirMessage.event.context) {\n              var mrn=null;\n              fhirMessage.event.context.forEach(contextResource => {\n                if (contextResource.key.toLowerCase()==='patient') {\n                  mrn=contextResource.resource.identifier[0].value;\n                }\n              });\n              console.debug('FhircastPanel: patient-open for mrn:'+mrn);\n              this._commandsManager.runCommand('navigateHistory',{to:'/?mrn='+mrn});\n            }  \n            else {\n              console.warn('FhircastPanel: mrn not found in  patient-open message.');\n            }               \n          }\n          if ( currentLocation!='' && fhirMessage.event['hub.event'].toLowerCase()==='patient-close') {\n            this._commandsManager.runCommand('navigateHistory',{to:'/'});\n          }\n          if (  fhirMessage.event['hub.event'].toLowerCase()==='imagingstudy-open') {\n            var studyUID=null;\n            fhirMessage.event.context.forEach(contextResource => {\n              if (contextResource.key.toLowerCase()==='study') {\n                studyUID=contextResource.resource.uid.replaceAll('urn:oid:','');\n              }\n            });\n            if (studyUID!==null && !currentLocation.includes(studyUID)){\n              console.debug('FhircastPanel:  imagingstudy-open, opening '+studyUID);\n              this._commandsManager.runCommand('navigateHistory',{to:'/viewer?StudyInstanceUIDs='+studyUID});\n            }\n            else if (studyUID===null) {\n              console.debug('FhircastPanel:  imagingstudy-open, studyUID not found in message');              \n            } else if (currentLocation.includes(studyUID)) {\n              console.debug('FhircastPanel:  imagingstudy-open, studyUID already open'); \n            }\n          }\n          if (  currentLocation!='' && fhirMessage.event['hub.event'].toLowerCase()==='imagingstudy-close') {\n            this._commandsManager.runCommand('navigateHistory',{to:'/'});\n          }\n          if ( fhirMessage.event['hub.event'].toLowerCase()==='diagnosticreport-open') {\n            const studyUID=fhirMessage.event.context[1].identifier[0].value;\n            console.debug('FhircastPanel:  Opening '+studyUID);\n            this._commandsManager.runCommand('navigateHistory',{to:'/viewer?StudyInstanceUIDs='+studyUID});\n          }\n          if (  currentLocation!='' && fhirMessage.event['hub.event'].toLowerCase()==='diagnosticreport-close') {\n            this._commandsManager.runCommand('navigateHistory',{to:'/'});\n          }\n        }              \n      }   \n    } catch(err){\n      console.warn('FhircastService: websocket setup error: ',err);\n    }       \n  } \n\n  private websocketClose() {\n    console.debug('FhircastService: websocket is closed.');\n    this.hub.resubscribeRequested=true;\n    this._broadcastEvent(FhircastService.EVENTS.WEBSOCKET_CLOSE,{});\n  }\n\n  public async fhircastSubscribe() {\n    if (this.hub.topic===undefined ) {\n      console.warn('FhircastService: Error. subscription not sent. No topic defined.');\n      return ('error: topic not defined');\n    }\n    const subscribeFormData= new URLSearchParams();  \n    subscribeFormData.append('hub.mode', 'subscribe');\n    subscribeFormData.append('hub.channel.type','websocket');\n    subscribeFormData.append('hub.callback',window.location.origin +'/fhircastCallback');\n    subscribeFormData.append('hub.events',this.hub.events.toString());\n    subscribeFormData.append('hub.topic',this.hub.topic);\n    subscribeFormData.append('hub.lease',this.hub.lease.toString());\n    subscribeFormData.append('subscriber.name',this.hub.subscriberName);\n    const requestOptions = {\n        method: 'POST',\n        headers: {  'Content-Type': 'application/x-www-form-urlencoded',\n                    'Authorization': 'Bearer ' +this.hub.token\n                },\n        body: subscribeFormData,\n        signal: AbortSignal.timeout(5000)\n    };\n    try {\n      const response = await fetch(this.hub.hub_endpoint,requestOptions);\n      if (response.status==202) {    \n        this.hub.subscribed=true;\n        this.hub.resubscribeRequested=false;\n        const subscriptionResponse=await response.json();\n        console.debug('FhircastService: subscribe response: '+JSON.stringify(subscriptionResponse));\n        const websocket_url=subscriptionResponse['hub.channel.endpoint'];           \n        this.hub.websocket = new WebSocket(websocket_url); //  open websocket  \n        this.hub.websocket.onopen = function () {\n          console.debug('FhircastService: websocket is connected.'); // Nuance wants the endpoint back after connection I think      \n          this.send('{\"hub.channel.endpoint\":\"'+websocket_url+'\"}');\n        }        \n        this.hub.websocket.addEventListener('message',(ev)=>this.processEvent(ev.data)) ;\n        this.hub.websocket.addEventListener('close',()=>this.websocketClose()) ;\n        this.hub.websocket.onerror = function () {console.warn('FhircastService: Error reported on websocket:'); }\n  \n        this._broadcastEvent(FhircastService.EVENTS.HUB_SUBSCRIBED,{});\n  \n      }\n      else {\n        console.debug('FhircastService: Subscription rejected by hub:',response.status);   \n      }\n      return(response.status);   \n    }\n    catch(err) {\n        console.warn('FhircastService: Error subscribing to the hub.', err.message);\n    }\n  }\n\n  public async fhircastPublish(fhircastMessage) {\n    const timestamp= new Date();\n    fhircastMessage.timestamp = timestamp.toJSON();\n    fhircastMessage.id = 'OHIF-'+Math.random().toString(36).substring(2, 16);\n    this.hub.lastPublishedMessageID=fhircastMessage.id;  // to filter event echo from the hub\n    fhircastMessage.event['hub.topic'] = this.hub.topic;\n    const message = JSON.stringify(fhircastMessage); \n    const requestOptions = {\n        method: 'POST',\n        headers: {  'Content-Type': 'application/json' , \n                    'Authorization': 'Bearer ' +this.hub.token\n                },\n        body: message\n    };\n    try {\n        console.debug(\"FhircastService: Publishing message to FHIRcast hub: \" + message)\n        var hubEndpoint=this.hub.hub_endpoint+'/'+this.hub.topic;\n        if (this.hub.productName==='PHILIPS') {\n            hubEndpoint=this.hub.hub_endpoint;\n        }\n        const response = await fetch(hubEndpoint,requestOptions);\n        return(response);\n    }\n    catch(err) {\n        console.debug(err.message);\n        return(null);\n    }\n  }\n\n  public async fhircastGetContext() {\n    console.debug(\"FhircastService: Retrieving context from FHIRcast hub.\");\n    try {\n      const requestOptions = {\n          method: 'GET',\n          headers: { 'Content-Type': 'application/json',\n          'Authorization': 'Bearer ' +this.hub.token\n          }\n      };\n      const response = await fetch(this.hub.hub_endpoint+'/'+this.hub.topic,requestOptions);\n      const context= await response.json();\n      return(context);\n    } catch(err) {\n          console.warn('FhircastService: get context error: ',err.message);\n          return(err.text);\n    }\n  } \n\n}\n\nexport default FhircastService;\nexport { EVENTS };\n\n\n","import { id } from './id';\nimport getPanelModule from './fhircast/getPanelModule';\nimport getCustomizationModule from './fhircast/getCustomizationModule';\nimport { ServicesManager, ExtensionManager, CommandsManager, DicomMetadataStore } from '@ohif/core';\nimport FhircastService from './services/FhircastService';\n\n\n\n\nexport default {\n\n  id,\n\n  //preRegistration: ({ servicesManager, commandsManager, configuration = {} }) => {\n    preRegistration: ({ servicesManager, commandsManager, extensionManager, configuration = {}}) => {\n\n      servicesManager.registerService(FhircastService.REGISTRATION);\n  },\n\n \n\n  getPanelModule,\n\n  getCustomizationModule,\n\n\n\n};\n","import React from 'react';\nimport { ServicesManager, CommandsManager, ExtensionManager } from '@ohif/core';\nimport { useViewportGrid } from '@ohif/ui';\nimport { MeasurementTable } from '@ohif/ui';\nimport FhircastPanel from './FhircastPanel';\nimport PowercastPanel from './PowercastPanel';\n\n\nexport default function getPanelModule({\n  commandsManager,\n  extensionManager,\n  servicesManager,\n}: {\n  servicesManager: ServicesManager;\n  commandsManager: CommandsManager;\n  extensionManager: ExtensionManager;\n}) {\n\n  const wrappedPowercastPanel = () => {\n    const [{ activeViewportId, viewports }] = useViewportGrid();\n\n    return (\n      <PowercastPanel\n        viewports={viewports}\n        activeViewportId={activeViewportId}\n        onSaveComplete={() => {}}\n        onRejectComplete={() => {}}\n        commandsManager={commandsManager}\n        servicesManager={servicesManager}\n        extensionManager={extensionManager}\n      />\n    );\n  };\n\n\n  const wrappedFhircastPanel = () => {\n    const [{ activeViewportId, viewports }] = useViewportGrid();\n\n    return (\n      <FhircastPanel\n        viewports={viewports}\n        activeViewportId={activeViewportId}\n        onSaveComplete={() => {}}\n        onRejectComplete={() => {}}\n        commandsManager={commandsManager}\n        servicesManager={servicesManager}\n        extensionManager={extensionManager}\n      />\n      \n    );\n  };\n\n\n\n  return [\n    {\n      name: 'PowercastPanel',\n      iconName: 'power-off',\n      iconLabel: 'power-off',\n      label: 'Powercast',\n      secondaryLabel: 'Measurements',\n      component: wrappedPowercastPanel,\n    },\n    {\n      name: 'FhircastPanel',\n      iconName: 'power-off',\n      iconLabel: 'power-off',\n      label: 'FHIRcast',\n      secondaryLabel: 'Measurements',\n      component: wrappedFhircastPanel,\n    },\n\n  ];\n}\n"],"names":["label","value","eventObject","servicesManager","commandsManager","extensionManager","FhircastService","services","hubConnected","sethubConnected","useState","tokenAcquired","setTokenAcquired","topic","setTopic","publishEvent","setPublishEvent","selectedHub","setSelectedHub","overwriteDataCheckbox","setOverwriteDataCheckbox","patientOpenCheckbox","setPatientOpenCheckbox","patientCloseCheckbox","setPatientCloseCheckbox","appConfig","useAppConfig","hub","name","friendlyName","productName","enabled","events","lease","hub_endpoint","authorization_endpoint","token_endpoint","token","subscribed","subscriberName","useEffect","getHub","fhircastEvent","EVENTS","FHIRCAST_MESSAGE","hubSubscribed","HUB_SUBSCRIBED","hubUnsubscribed","HUB_UNSUBSCRIBED","websocketClose","WEBSOCKET_CLOSE","subscriptions","forEach","evt","unsubscribe","subscribe","console","debug","push","unsub","patientOpenCheckboxClick","React","className","Select","id","options","fhircast","hubs","onChange","changeHub","selected","setHub","Button","type","ButtonEnums","secondary","disabled","onClick","async","getToken","size","Label","InputText","newValue","undefined","getTopic","fhircastSubscribe","fhircastUnsubscribe","response","fhircastGetContext","JSON","stringify","alert","err","warn","message","checked","testData","defaultValue","eventObj","filter","e","event","toLowerCase","viewportGridService","displaySetService","cornerstoneViewportService","displaySet","getActiveDisplaySets","instance","instances","StudyInstanceUID","context","resource","uid","fhircastPublish","statusText","overwriteDataCheckboxClick","patientCloseCheckboxClick","configuration","setconfiguration","authorization","setWauthorization","connector_endpoint","requestOptions","method","headers","fetch","status","json","powercastGetConfiguration","powercastConnector","connector_config_endpoint","readOnly","rows","cols","CallbackCheck","TOKEN_ACQUIRED","STUDY_CLOSE","PubSubService","constructor","super","_extensionManager","_servicesManager","_commandsManager","lastPublishedMessageID","resubscribeRequested","websocket","fhircastConfig","window","config","checkWebsocket","this","defaultHub","autoStart","interval","setInterval","createImagingStudyClose","StudyUID","timestamp","createImagingStudyOpen","key","resourceType","identifier","system","patient","reference","hubName","hubconfig","Math","random","toString","substring","tokenFormData","URLSearchParams","append","process","body","access_token","_broadcastEvent","subscribeFormData","location","origin","signal","AbortSignal","timeout","close","processEvent","eventData","fhirMessage","parse","currentLocation","search","mrn","contextResource","runCommand","to","studyUID","replaceAll","includes","subscriptionResponse","websocket_url","WebSocket","onopen","send","addEventListener","ev","data","onerror","fhircastMessage","Date","toJSON","hubEndpoint","text","_FhircastService","REGISTRATION","altName","create","preRegistration","registerService","getPanelModule","iconName","iconLabel","secondaryLabel","component","wrappedPowercastPanel","activeViewportId","viewports","useViewportGrid","PowercastPanel","onSaveComplete","onRejectComplete","wrappedFhircastPanel","FhircastPanel","getCustomizationModule","routes","path","children"],"sourceRoot":""}