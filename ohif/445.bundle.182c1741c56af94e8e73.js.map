{"version":3,"file":"445.bundle.182c1741c56af94e8e73.js","mappings":"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","sources":["webpack:///../../../../../fhir-integration/src/fhircast/fhircastTestData.js","webpack:///../../../../../fhir-integration/src/fhircast/FhircastPanel.tsx","webpack:///../../../../../fhir-integration/src/fhircast/PowercastPanel.tsx","webpack:///../../../../../fhir-integration/src/fhircast/powercast.js","webpack:///../../../../../fhir-integration/src/fhircast/getCustomizationModule.tsx","webpack:///../../../../../fhir-integration/src/services/conferenceModal.tsx","webpack:///../../../../../fhir-integration/src/services/FhircastService.ts","webpack:///../../../../../fhir-integration/src/index.tsx","webpack:///../../../../../fhir-integration/src/fhircast/getPanelModule.tsx"],"sourcesContent":["const testData=  [\n\n\n  {\n    label: \"ImagingStudy-open\",\n    value: \"ImagingStudy-open\",\n    eventObject: {\n      \"timestamp\": \"2018-01-08T01:37:05.14\",\n    \"id\": \"q9v3jubddqt63n1\",\n    \"event\": {\n      \"hub.topic\": \"fdb2f928-5546-4f52-87a0-0648e9ded065\",\n      \"hub.event\": \"imagingstudy-open\",\n      \"context\": [\n        {\n          \"key\": \"patient\",\n          \"resource\": {\n            \"resourceType\": \"Patient\",\n            \"id\": \"ewUbXT9RWEbSj5wPEdgRaBw3\",\n            \"identifier\": [\n              {\n                \"system\": \"urn:oid:1.2.840.114350\",\n                \"value\": \"185444\"\n              },\n              {\n                \"system\": \"urn:oid:1.2.840.114350.1.13.861.1.7.5.737384.27000\",\n                \"value\": \"2667\"\n              }\n            ]\n          }\n        },\n        {\n          \"key\": \"study\",\n          \"resource\": {\n            \"resourceType\": \"ImagingStudy\",\n            \"id\": \"8i7tbu6fby5ftfbku6fniuf\",\n            \"uid\": \"urn:oid:2.16.840.1.114362.1.11972228.22789312658.616067305.306.2\",\n            \"identifier\": [\n              {\n                \"system\": \"7678\",\n                \"value\": \"185444\"\n              }\n            ],\n            \"patient\": {\n              \"reference\": \"Patient/ewUbXT9RWEbSj5wPEdgRaBw3\"\n            }\n          }\n        }\n      ]\n    }\n  }\n},\n\n{\n  label: \"ImagingStudy-close\",\n  value: \"ImagingStudy-close\",\n  eventObject: {\n    \"timestamp\": \"2018-01-08T01:37:05.14\",\n  \"id\": \"q9v3jubddqt63n1\",\n  \"event\": {\n    \"hub.topic\": \"fdb2f928-5546-4f52-87a0-0648e9ded065\",\n    \"hub.event\": \"imagingstudy-close\",\n    \"context\": [\n      {\n        \"key\": \"patient\",\n        \"resource\": {\n          \"resourceType\": \"Patient\",\n          \"id\": \"ewUbXT9RWEbSj5wPEdgRaBw3\",\n          \"identifier\": [\n            {\n              \"system\": \"urn:oid:1.2.840.114350\",\n              \"value\": \"185444\"\n            },\n            {\n              \"system\": \"urn:oid:1.2.840.114350.1.13.861.1.7.5.737384.27000\",\n              \"value\": \"2667\"\n            }\n          ]\n        }\n      },\n      {\n        \"key\": \"study\",\n        \"resource\": {\n          \"resourceType\": \"ImagingStudy\",\n          \"id\": \"8i7tbu6fby5ftfbku6fniuf\",\n          \"uid\": \"urn:oid:2.16.840.1.114362.1.11972228.22789312658.616067305.306.2\",\n          \"identifier\": [\n            {\n              \"system\": \"7678\",\n              \"value\": \"185444\"\n            }\n          ],\n          \"patient\": {\n            \"reference\": \"Patient/ewUbXT9RWEbSj5wPEdgRaBw3\"\n          }\n        }\n      }\n    ]\n  }\n}\n},\n{\n  label: \"Conference-start\",\n  value: \"Conference-start\",\n  eventObject: {\"timestamp\":\"\",\n              \"id\":\"\",\n              \"event\":{\n                \"hub.topic\":\"\",\n                \"hub.event\":\"conference-start\",\n              }\n            }\n}\n,\n{\n  label: \"Conference-end\",\n  value: \"Conference-end\",\n  eventObject: {\"timestamp\":\"\",\n              \"id\":\"\",\n              \"event\":{\n                \"hub.topic\":\"\",\n                \"hub.event\":\"conference-end\",\n              }\n            }\n}\n,\n{\n  label: \"Patient-open\",\n  value: \"Patient-open\",\n  eventObject: {\"timestamp\":\"\",\n              \"id\":\"\",\n              \"event\":{\n                \"hub.topic\":\"b073c35e-d86e-4ae0-a8b7-e8804dc50fd1\",\n                \"hub.event\":\"patient-open\",\n                \"context\":[{  \n                  \"key\":\"patient\",\n                  \"resource\":{\n                    \"resourceType\":\"Patient\",\n                    \"id\":\"645d87b8-4710-4837-97f4-aeecf3566ac8\",\n                    \"identifier\":[{\n                      \"type\":{\n                        \"coding\":[{\n                          \"system\":\"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                          \"code\":\"MR\",\"display\":\"Medical Record Number\"}]\n                        },\n                      \"value\":\"M1\"\n                      }]\n                  }}]}}\n},\n{\n  label: \"Patient-close\",\n  value: \"Patient-close\",\n  eventObject: {\"timestamp\":\"\",\n              \"id\":\"\",\n              \"event\":{\n                \"hub.topic\":\"b073c35e-d86e-4ae0-a8b7-e8804dc50fd1\",\n                \"hub.event\":\"patient-close\",\n                \"context\":[{  \n                  \"key\":\"patient\",\n                  \"resource\":{\n                    \"resourceType\":\"Patient\",\n                    \"id\":\"645d87b8-4710-4837-97f4-aeecf3566ac8\",\n                    \"identifier\":[{\n                      \"type\":{\n                        \"coding\":[{\n                          \"system\":\"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                          \"code\":\"MR\",\"display\":\"Medical Record Number\"}]}}]}}]}}\n},\n\n  {\n    label: \"[RAD-148] DiagnoticReport-open\",\n    value: \"[RAD-148] DiagnoticReport-open\",\n    eventObject: {\n        \"timestamp\": \"\",\n        \"id\": \"\",\n        \"event\": {\n          \"hub.topic\": \"\",\n          \"hub.event\": \"diagnosticreport-open\",\n          \"context\": [\n            {\n              \"key\": \"report\",\n              \"resource\": {\n                \"resourceType\": \"DiagnosticReport\",\n                \"id\": \"2402d3bd-e988-414b-b7f2-4322e86c9327\",\n                \"status\": \"unknown\",\n                \"basedOn\" : [\n                  {\n                    \"type\" : \"ServiceRequest\",\n                    \"identifier\" : {\n                      \"type\" : {\n                        \"coding\" : [\n                          {\n                            \"system\" : \"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                            \"code\" : \"ACSN\"\n                          }\n                        ]\n                      },\n                      \"system\" : \"urn:oid:2.16.840.1.113883.19.5\",\n                      \"value\" : \"GH339884\",\n                      \"assigner\" : {\n                        \"reference\" : \"Organization/a92ac1be-fb34-49c1-be58-10928bd271cc\",\n                        \"display\" : \"My Healthcare Provider\"\n                      }\n                    }\n                  }\n                ],\n                \"code\" : {\n                  \"coding\" : [\n                    {\n                      \"system\" : \"http://loinc.org\",\n                      \"code\" : \"19005-8\",\n                      \"display\": \"Radiology Imaging study [Impression] (narrative)\"\n                    }\n                  ]\n                },\n                \"subject\": {\n                  \"reference\": \"Patient/503824b8-fe8c-4227-b061-7181ba6c3926\"\n                },\n                \"study\": [\n                  {\n                    \"reference\": \"ImagingStudy/e25c1d31-20a2-41f8-8d85-fe2fdeac74fd\"\n                  }\n                ]\n              }\n            },\n            {\n              \"key\": \"study\",\n              \"resource\": {\n                \"resourceType\": \"ImagingStudy\",\n                \"id\": \"e25c1d31-20a2-41f8-8d85-fe2fdeac74fd\",\n                \"identifier\": [\n                  {\n                    \"system\" : \"urn:dicom:uid\",\n                    \"value\" : \"urn:oid:2.16.840.1.114362.1.11972228.22789312658.616067305.306.2\"\n                  }\n                ],\n                \"status\": \"unknown\",\n                \"subject\": {\n                  \"reference\": \"Patient/503824b8-fe8c-4227-b061-7181ba6c3926\"\n                },\n                \"basedOn\" : [\n                  {\n                    \"type\" : \"ServiceRequest\",\n                    \"identifier\" : {\n                      \"type\" : {\n                        \"coding\" : [\n                          {\n                            \"system\": \"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                            \"code\" : \"ACSN\"\n                          }\n                        ]\n                      },\n                      \"system\" : \"urn:oid:2.16.840.1.113883.19.5\",\n                      \"value\" : \"GH339884\",\n                      \"assigner\" : {\n                        \"reference\" : \"Organization/a92ac1be-fb34-49c1-be58-10928bd271cc\",\n                        \"display\" : \"My Healthcare Provider\"\n                      }\n                    }\n                  }\n                ]\n              }\n            },\n            {\n              \"key\": \"patient\",\n              \"resource\": {\n                \"resourceType\": \"Patient\",\n                \"id\": \"503824b8-fe8c-4227-b061-7181ba6c3926\",\n                \"identifier\" : [\n                  {\n                    \"use\" : \"official\",\n                    \"type\" : {\n                      \"coding\" : [\n                        {\n                          \"system\" : \"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                          \"code\" : \"MR\"\n                        }\n                      ]\n                    },\n                    \"system\": \"urn:oid:2.16.840.1.113883.19.5\",\n                    \"value\": \"4438001\",\n                    \"assigner\": {\n                      \"reference\": \"Organization/a92ac1be-fb34-49c1-be58-10928bd271cc\",\n                      \"display\": \"My Healthcare Provider\"\n                    }\n                  }\n                ],\n                \"name\" : [\n                  {\n                    \"use\" : \"official\",\n                    \"family\" : \"Smith\",\n                    \"given\" : [\n                      \"John\"\n                    ],\n                    \"prefix\" : [\n                      \"Dr.\"\n                    ],\n                    \"suffix\" : [\n                      \"Jr.\",\n                      \"M.D.\"\n                    ]\n                  }\n                ],\n                \"gender\" : \"male\",\n                \"birthDate\" : \"1978-11-03\"\n              }\n            }\n          ]\n        }\n      }\n  },\n  {\n    label: \"[RAD-149] DiagnoticReport-close\",\n    value: \"[RAD-149] DiagnoticReport-close\",\n    eventObject: \n    {\n      \"timestamp\": \"\",\n      \"id\": \"\",\n      \"event\": {\n        \"hub.topic\": \"\",\n        \"hub.event\": \"diagnosticreport-close\",\n        \"context\": [\n          {\n            \"key\": \"report\",\n            \"resource\": {\n              \"resourceType\": \"DiagnosticReport\",\n              \"id\": \"2402d3bd-e988-414b-b7f2-4322e86c9327\",\n              \"identifier\" : [\n                {\n                  \"use\" : \"official\",\n                  \"system\" : \"http://myhealthcare.com/reporting-system\",\n                  \"value\" : \"GH339884.RPT.0001\"\n                }\n              ],\n              \"status\": \"unknown\",\n              \"basedOn\" : [\n                {\n                  \"type\" : \"ServiceRequest\",\n                  \"identifier\" : {\n                    \"type\" : {\n                      \"coding\" : [\n                        {\n                          \"system\" : \"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                          \"code\" : \"ACSN\"\n                        }\n                      ]\n                    },\n                    \"system\" : \"urn:oid:2.16.840.1.113883.19.5\",\n                    \"value\" : \"GH339884\",\n                    \"assigner\" : {\n                      \"reference\" : \"Organization/a92ac1be-fb34-49c1-be58-10928bd271cc\",\n                      \"display\" : \"My Healthcare Provider\"\n                    }\n                  }\n                }\n              ],\n              \"code\" : {\n                \"coding\" : [\n                  {\n                    \"system\" : \"http://loinc.org\",\n                    \"code\" : \"19005-8\",\n                    \"display\": \"Radiology Imaging study [Impression] (narrative)\"\n                  }\n                ]\n              },\n              \"subject\": {\n                \"reference\": \"Patient/503824b8-fe8c-4227-b061-7181ba6c3926\"\n              },\n              \"imagingStudy\": [\n                {\n                  \"reference\": \"ImagingStudy/e25c1d31-20a2-41f8-8d85-fe2fdeac74fd\"\n                }\n              ]\n            }\n          },\n          {\n            \"key\": \"study\",\n            \"resource\": {\n              \"resourceType\": \"ImagingStudy\",\n              \"id\": \"e25c1d31-20a2-41f8-8d85-fe2fdeac74fd\",\n              \"identifier\": [\n                {\n                  \"system\" : \"urn:dicom:uid\",\n                  \"value\" : \"urn:oid:1.2.840.83474.8.231.875.3.15.661594731\"\n                }\n              ],\n              \"status\": \"unknown\",\n              \"subject\": {\n                \"reference\": \"Patient/503824b8-fe8c-4227-b061-7181ba6c3926\"\n              },\n              \"basedOn\" : [\n                {\n                  \"type\" : \"ServiceRequest\",\n                  \"identifier\" : {\n                    \"type\" : {\n                      \"coding\" : [\n                        {\n                          \"system\": \"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                          \"code\" : \"ACSN\"\n                        }\n                      ]\n                    },\n                    \"system\" : \"urn:oid:2.16.840.1.113883.19.5\",\n                    \"value\" : \"GH339884\",\n                    \"assigner\" : {\n                      \"reference\" : \"Organization/a92ac1be-fb34-49c1-be58-10928bd271cc\",\n                      \"display\" : \"My Healthcare Provider\"\n                    }\n                  }\n                }\n              ]\n            }\n          },\n          {\n            \"key\": \"patient\",\n            \"resource\": {\n              \"resourceType\": \"Patient\",\n              \"id\": \"503824b8-fe8c-4227-b061-7181ba6c3926\",\n              \"identifier\" : [\n                {\n                  \"use\" : \"official\",\n                  \"type\" : {\n                    \"coding\" : [\n                      {\n                        \"system\" : \"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                        \"code\" : \"MR\"\n                      }\n                    ]\n                  },\n                  \"system\": \"urn:oid:2.16.840.1.113883.19.5\",\n                  \"value\": \"4438001\",\n                  \"assigner\": {\n                    \"reference\": \"Organization/a92ac1be-fb34-49c1-be58-10928bd271cc\",\n                    \"display\": \"My Healthcare Provider\"\n                  }\n                }\n              ]\n            }\n          }\n        ]\n      }\n    }\n  },\n  {\n    label: \"[RAD-150] DiagnoticReport-update\",\n    value: \"[RAD-150] DiagnoticReport-update\",\n    eventObject: \n    {\n      \"timestamp\": \"\",\n      \"id\": \"\",\n      \"event\": {\n        \"hub.topic\": \"\",\n        \"hub.event\": \"DiagnosticReport-update\",\n        \"context.versionId\": \"\",\n        \"context\": [\n          {\n            \"key\": \"report\",\n            \"resource\": {\n              \"resourceType\": \"DiagnosticReport\",\n              \"id\": \"2402d3bd-e988-414b-b7f2-4322e86c9327\",\n              \"status\": \"unknown\",\n              \"code\" : {\n                \"coding\" : [\n                  {\n                    \"system\" : \"http://loinc.org\",\n                    \"code\" : \"19005-8\",\n                    \"display\": \"Radiology Imaging study [Impression] (narrative)\"\n                  }\n                ]\n              }\n            }\n          },\n          {\n            \"key\": \"updates\",\n            \"resource\": {\n              \"resourceType\": \"Bundle\",\n              \"type\": \"transaction\",\n              \"entry\": [\n                {\n                  \"request\": {\n                    \"method\": \"PUT\"\n                  },\n                  \"resource\": {\n                    \"resourceType\": \"ImagingStudy\",\n                    \"description\": \"CHEST XRAY\",\n                    \"started\": \"2010-02-14T01:10:00.000Z\",\n                    \"id\": \"7e9deb91-0017-4690-aebd-951cef34aba4\",\n                    \"identifier\": [\n                      {\n                        \"type\": {\n                          \"coding\": [\n                            {\n                              \"system\": \"http://terminology.hl7.org/CodeSystem/v2-0203\",\n                              \"code\": \"ACSN\"\n                            }\n                          ]\n                        },\n                        \"value\": \"3478116342\"\n                      },\n                      {\n                        \"system\": \"urn:dicom:uid\",\n                        \"value\": \"urn:oid:2.16.124.113543.6003.1154777499.30276.83661.3632298176\"\n                      }\n                    ]\n                  }\n                },\n                {\n                  \"request\": {\n                    \"method\": \"PUT\"\n                  },\n                  \"resource\": {\n                    \"resourceType\": \"Observation\",\n                    \"id\": \"40afe766-3628-4ded-b5bd-925727c013b3\",\n                    \"partOf\": {\n                      \"reference\": \"ImagingStudy/7e9deb91-0017-4690-aebd-951cef34aba4\"\n                    },\n                    \"status\": \"preliminary\",\n                    \"category\": {\n                      \"system\": \"http://terminology.hl7.org/CodeSystem/observation-category\",\n                      \"code\": \"imaging\",\n                      \"display\": \"Imaging\"\n                    },\n                    \"code\": {\n                      \"coding\": [\n                        {\n                          \"system\": \"http://www.radlex.org\",\n                          \"code\": \"RID49690\",\n                          \"display\": \"simple cyst\"\n                        }\n                      ] \n                    },\n                    \"issued\": \"2020-09-07T15:02:03.651Z\"\n                  }\n                }\n              ]\n            }\n          }\n        ]\n      }\n    }\n  },\n  {\n    label: \"[RAD-151] DiagnoticReport-select\",\n    value: \"[RAD-151] DiagnoticReport-select\",\n    eventObject: \n    {\n      \"timestamp\": \"\",\n      \"id\": \"\",\n      \"event\": {\n        \"hub.topic\": \"\",\n        \"hub.event\": \"DiagnosticReport-select\",\n        \"context\": [\n          {\n            \"key\": \"report\",\n            \"resource\": {\n              \"resourceType\": \"DiagnosticReport\",\n              \"id\": \"2402d3bd-e988-414b-b7f2-4322e86c9327\",\n              \"status\": \"unknown\",\n              \"code\" : {\n                \"coding\" : [\n                  {\n                    \"system\" : \"http://loinc.org\",\n                    \"code\" : \"19005-8\",\n                    \"display\": \"Radiology Imaging study [Impression] (narrative)\"\n                  }\n                ]\n              }\n            }\n          },\n          {\n            \"key\": \"select\",\n            \"resources\": [\n              {\n                \"resourceType\": \"Observation\",\n                \"id\": \"40afe766-3628-4ded-b5bd-925727c013b3\"\n              }\n            ]\n          }\n        ]\n      }\n    }\n  },\n  {\n    label: \"[RAD-156] sync-error\",\n    value: \"[RAD-156] sync-error\",\n    eventObject:\n    {\n      \"timestamp\": \"\",\n      \"id\": \"\",\n      \"event\": {\n        \"hub.topic\": \"\",\n        \"hub.event\": \"syncerror\",\n        \"context\": [\n          {\n            \"key\": \"operationoutcome\",\n            \"resource\": {\n              \"resourceType\": \"OperationOutcome\",\n              \"issue\": [\n                {\n                  \"severity\": \"warning\",\n                  \"code\": \"processing\",\n                  \"diagnostics\": \"Acme Product failed to follow context\",\n                  \"details\": {\n                    \"coding\": [\n                      {\n                        \"system\": \"https://fhircast.hl7.org/events/syncerror/eventid\",\n                        \"code\": \"fdb2f928-5546-4f52-87a0-0648e9ded065\"\n                      },\n                      {\n                        \"system\": \"https://fhircast.hl7.org/events/syncerror/eventname\",\n                        \"code\": \"Patient-open\"\n                      },\n                      {\n                        \"system\": \"https://fhircast.hl7.org/events/syncerror/subscriber\",\n                        \"code\": \"Acme Product\"\n                      },\n                      {\n                        \"system\": \"http://example.com/events/syncerror/your-error-code-system\",\n                        \"code\": \"FHIRcast sync error\"\n                      }\n                    ]\n                  }\n                }\n              ]\n            }\n          }\n        ]\n      }\n    }\n  },\n  \n\n  ];\n  \n  export default testData;","import React, { useState, useEffect } from 'react';\nimport { ServicesManager, CommandsManager} from '@ohif/core';\nimport  { Button, ButtonEnums,Label,Select,InputText,Checkbox } from '@ohif/ui'\nimport testData from './fhircastTestData'\nimport { useAppConfig } from '@state';\n\nfunction FhircastPanel({\n  servicesManager,\n  commandsManager,\n  extensionManager,\n}): React.FunctionComponent { \n \n\n  const {FhircastService}=servicesManager.services;\n  const [hubConnected, sethubConnected] = useState(false); \n  const [tokenAcquired, setTokenAcquired] = useState(false);\n  const [topic,setTopic]=useState('FHIRcast conference');\n  const [publishEvent,setPublishEvent]=useState({label:'ImagingStudy-open',value: 'ImagingStudy-open'});\n  const [selectedHub,setSelectedHub]=useState({value:'TEST',label:'TEST-FHIRcast Javascript Sandbox'});  \n\n  const [overwriteDataCheckbox,setOverwriteDataCheckbox]=useState(false);\n  const [patientOpenCheckbox,setPatientOpenCheckbox]=useState(true);\n  const [patientCloseCheckbox,setPatientCloseCheckbox]=useState(true);\n  const [imagingStudyOpenCheckbox,setImagingStudyOpenCheckbox]=useState(true);\n  const [imagingStudyCloseCheckbox,setImagingStudyCloseCheckbox]=useState(true);\n  const [diagnosticReportOpenCheckbox,setDiagnosticReportOpenCheckbox]=useState(true);\n  const [diagnosticReportCloseCheckbox,setDiagnosticReportCloseCheckbox]=useState(true);\n\n  const [sendIMOpen,setSendIMOpen]=useState(true);\n  const [sendIMClose,setSendIMClose]=useState(true);\n\n  const [appConfig] =useAppConfig();\n \n  let hub={\n    name:'',\n    friendlyName:'',\n    productName :'',\n    enabled:false,\n    events: [],\n    lease:999,\n    hub_endpoint: '',\n    authorization_endpoint: '',\n    token_endpoint: '',\n    token:'',\n    subscribed:false,\n    subscriberName:''\n  };\n\n\n  function getHubOptions(){   // used to fill the hub select drop down\n    var options=[];\n    if (appConfig.fhircast.hubs) {\n      appConfig.fhircast.hubs.forEach(hub =>\n      {\n        if (hub.enabled) {\n          options.push({label:hub.name+'-'+hub.friendlyName,value:hub.name});\n        }\n      })\n    }\n    return options;\n  }\n\n  \n  const getTokenClick= async() => {\n    console.debug('FhircastPanel: Getting token from the  hub: ' + FhircastService.getHub().name); \n    var succeeded= await FhircastService.getToken();\n    if (succeeded) {\n      setTokenAcquired(true);\n      if (FhircastService.getHub.subscribed) {sethubConnected(true);}\n    }\n  }\n\n  useEffect(() => {\n    hub=FhircastService.getHub();\n    if (hub.subscribed)  {sethubConnected(true); }\n    if (hub.token != '') {setTokenAcquired(true); }\n    setSelectedHub({label: hub.name,value:hub.friendlyName });\n    setTopic(FhircastService.getTopic())\n    // ~~ Subscription\n    const fhircastEvent = FhircastService.EVENTS.FHIRCAST_MESSAGE;\n    const hubSubscribed= FhircastService.EVENTS.HUB_SUBSCRIBED;\n    const hubUnsubscribed= FhircastService.EVENTS.HUB_UNSUBSCRIBED;\n    const websocketClose = FhircastService.EVENTS.WEBSOCKET_CLOSE;\n    const subscriptions = [];\n    [fhircastEvent, hubSubscribed, hubUnsubscribed,websocketClose,].forEach(evt => {\n      const { unsubscribe } = FhircastService.subscribe(evt, () => {      \n        if ( evt==='tokenAcquired' ) {\n          setTokenAcquired(true);\n          console.debug('FhircastPanel: tokenAcquired event received.');\n        }\n        if (evt==='hubSubscribed') {\n          sethubConnected(true);\n          console.debug('FhircastPanel: hubSubscribed event received.');\n        }\n        if (evt==='hubUnsubscribed'  ) {\n          sethubConnected(false);\n          console.debug('FhircastPanel: hubUnsubscribed event received.');\n        }\n        if ( evt==='websocketClose' ) {\n          sethubConnected(false);\n          console.debug('FhircastPanel: websocketClose event received.');\n        }\n        if (evt==='fhircastMessage') {\n          console.debug('FhircastPanel: fhircastMessage event received.');\n        }\n      });\n      subscriptions.push(unsubscribe);\n    });\n    return () => {\n      subscriptions.forEach(unsub => {\n        unsub();\n      });\n    };\n  },[]);\n\n  const subscribeClick= async() => {\n    console.debug('FhircastPanel: Subscribing to the hub.');\n    if (FhircastService.getTopic() === undefined) {\n      FhircastService.setTopic(topic);\n    }\n    var response= await FhircastService.fhircastSubscribe();\n    if (response==202) {\n      sethubConnected(true);\n    }\n  }\n\n  const unsubscribeClick= async() => {\n    console.debug('FhircastPanel: Unsubscribing from the hub.');\n    var response= await FhircastService.fhircastUnsubscribe();\n    if (response==202) {\n      sethubConnected(false);\n    } else {\n      sethubConnected(false);\n    }\n  }\n\n  const publishClick= async() => {\n    try {\n        console.debug('FhircastPanel: calling publish');\n        var eventObj=testData.filter(e=>e.label===publishEvent.label);\n        if (overwriteDataCheckbox && eventObj[0].eventObject.event['hub.event'].toLowerCase()==='imagingstudy-open') {\n          console.debug('FhircastPanel: Publishing ImagingStudy event from current active display port.');\n          const { viewportGridService, displaySetService, cornerstoneViewportService } = servicesManager.services;\n          const displaySets = displaySetService.getActiveDisplaySets();\n          const displaySet = displaySets[0];\n          const instance = displaySet?.instances?.[0] || displaySet?.instance;\n          if (instance) {\n            console.debug('FhircastPanel: Publishing ImagingStudy '+ instance.StudyInstanceUID);\n            eventObj[0].eventObject.event.context[1].resource.uid='urn:oid:'+instance.StudyInstanceUID;\n          }\n        }\n        var response=await FhircastService.fhircastPublish(eventObj[0].eventObject,); \n        console.debug('FhircastPanel: publish response: ',response.statusText);\n      }\n      catch (err) {\n        console.warn('FhircastPanel: publish error: ',err.message);\n      }\n  }\n\n\n  const getContextClick= async() => {\n    console.debug('FhircastPanel: Fetching current context from the hub.');\n    try {\n      var response=await FhircastService.fhircastGetContext(); \n      console.debug('FhircastPanel: Get Context response: ',JSON.stringify(response));\n      alert(JSON.stringify(response));\n    } catch(err) {\n      console.warn('FhircastPanel: Get Context error ',err.message);\n    }\n  }\n\n  const handleChange=()=>{}\n  \n  const patientOpenCheckboxClick =()=>{\n    setPatientOpenCheckbox(!patientOpenCheckbox);\n  }\n  const patientCloseCheckboxClick =()=>{\n    setPatientCloseCheckbox(!patientCloseCheckbox);\n  }\n  const imagingStudyOpenCheckboxClick =()=>{\n    setImagingStudyOpenCheckbox(!imagingStudyOpenCheckbox);\n  }\n  const imagingStudyCloseCheckboxClick =()=>{\n    setImagingStudyCloseCheckbox(!imagingStudyCloseCheckbox);\n  }\n  const diagnosticReportOpenCheckboxClick =()=>{\n    setDiagnosticReportOpenCheckbox(!diagnosticReportOpenCheckbox);\n  }\n  const diagnosticReportCloseCheckboxClick =()=>{\n    setDiagnosticReportCloseCheckbox(!diagnosticReportCloseCheckbox);\n  }\n\n  const overwriteDataCheckboxClick =()=>{\n    setOverwriteDataCheckbox(!overwriteDataCheckbox);\n  }\n  const sendIMOpenCheckboxClick =()=>{\n    setSendIMOpen(!sendIMOpen);\n  }\n  const sendIMCloseCheckboxClick =()=>{\n    setSendIMClose(!sendIMClose);\n  }\n\n  const changeHub=(selected)=>{\n    setSelectedHub(selected);\n    sethubConnected(false);\n    setTokenAcquired(false);\n    FhircastService.setHub(selected.value);\n  }\n  return (\n    <>\n      <div className=\"bg-secondary-main flex justify-between px-2 py-1\">\n        <span className=\"text-base center font-bold uppercase tracking-widest text-white\">FHIRcast</span>     \n      </div>\n      <div className=\"ohif-scrollbar  overflow-y-auto overflow-x-hidden text-primary-light  text-base\"> \n      <hr/>\n      <label className=\"leading-[1.2] text-[12px]\">Hub status: </label> \n      {hubConnected && <label className=\" leading-[1.2] text-white\">SUBSCRIBED</label>}\n      {!hubConnected && <label className=\" leading-[1.2] text-white\">NOT SUBSCRIBED</label>}       \n      <br/>\n      <Select \n        id='hub'\n        options={getHubOptions()}\n        value={selectedHub}\n        onChange={value => changeHub(value)}\n        />\n      <Button \n        type={ButtonEnums.type.secondary}\n        disabled={false}\n        onClick= {getTokenClick}\n        size='small'\n        >Get token\n      </Button>\n      <br/><hr/>\n      <Label className=\" leading-[1.2] text-primary-light \" >Subscribe to a topic:\n        <InputText \n          label=''\n          id='topic' \n          disabled={hubConnected || !tokenAcquired}\n          value={topic}\n          onChange={newValue=> {  \n              setTopic(newValue); \n              FhircastService.setTopic(newValue);\n              }}>\n        </InputText>\n      </Label>\n      <br/>\n      <Button \n        type={ButtonEnums.type.secondary}\n        disabled={hubConnected || !tokenAcquired}\n        onClick= {subscribeClick}\n        size='small'\n        >Subscribe\n      </Button>\n      <Button \n        type={ButtonEnums.type.secondary}\n        disabled={!hubConnected || !tokenAcquired}\n        onClick= {unsubscribeClick}\n        size='small'\n        >Unsubscribe\n      </Button>\n      <br/><hr/>\n      <Button \n      type={ButtonEnums.type.secondary}\n      disabled={!tokenAcquired}\n      onClick= {getContextClick}\n      size='small'    \n      >Get context\n      </Button>\n      <label>Auto-load context:\n        <input type='checkbox' checked={!patientOpenCheckbox} onChange={patientOpenCheckboxClick}/>    \n      </label>\n      <br/><hr/>\n      <p>Publish an event:</p>\n      <Select \n        id='eventSelect'\n        options={testData}\n        value={publishEvent}\n        onChange={value => {setPublishEvent({label: value.value});}}\n        defaultValue=  {{label:'ImagingStudy-open',value: 'ImagingStudy-open'}}\n      />    \n      <Button \n        type={ButtonEnums.type.secondary}\n        disabled={!tokenAcquired}\n        onClick= {publishClick}\n        size='small'  \n      >Publish\n      </Button>\n      <label>Overwrite test data:\n        <input type='checkbox' checked={overwriteDataCheckbox} onChange={overwriteDataCheckboxClick}/>    \n      </label>\n      <br/><hr/>\n      <p>Handle events from this hub:</p>\n\n       <br/>\n      <label>Patient-open:\n        <input type='checkbox' checked={patientOpenCheckbox} onChange={patientOpenCheckboxClick}/>    \n      </label><br/>\n      <label>Patient-close:\n        <input type='checkbox' checked={patientCloseCheckbox} onChange={patientCloseCheckboxClick}/>    \n      </label><br/>\n      <label>ImagingStudy-open:\n        <input type='checkbox' checked={imagingStudyOpenCheckbox} onChange={imagingStudyOpenCheckboxClick}/>    \n      </label><br/>\n      <label>ImagingStudy-close:\n        <input type='checkbox' checked={imagingStudyCloseCheckbox} onChange={imagingStudyCloseCheckboxClick}/>    \n      </label><br/>\n      <label>DiagnosticReport-open:\n        <input type='checkbox' checked={diagnosticReportOpenCheckbox} onChange={diagnosticReportOpenCheckboxClick}/>    \n      </label><br/>\n      <label>DiagnosticReport-close:\n        <input type='checkbox' checked={diagnosticReportOpenCheckbox} onChange={diagnosticReportOpenCheckboxClick}/>       \n      </label><br/>\n      <br/><hr/>\n      <p>Send events to this hub:</p>\n      <br/>\n      <label>ImagingStudy-open:\n        <input type='checkbox' checked={sendIMOpen} onChange={sendIMOpenCheckboxClick} />    \n      </label><br/>\n      <label>ImagingStudy-close:\n        <input type='checkbox' checked={sendIMClose} onChange={sendIMCloseCheckboxClick} />   \n      </label><br/>\n\n    </div>\n    </>\n  );\n\n}\n//setSendIMOpen(!sendIMOpen) \n //setSendIMClose(!sendIMClose)\nexport default FhircastPanel;\n","import React, { useState, useEffect } from 'react';\nimport { ServicesManager, ExtensionManager, CommandsManager, DicomMetadataStore } from '@ohif/core';\nimport  { Button, ButtonEnums,Label,Select,InputText } from '@ohif/ui'\nimport {powercastGetConfiguration} from './powercast'\nimport { useAppConfig } from '@state';\n\nfunction PowercastPanel(){ \n\n  const [configuration, setconfiguration] = useState('');\n  const [authorization, setWauthorization] = useState('');\n  const [appConfig] =useAppConfig();\n\n    const getConfigurationClick= async() => {\n        console.debug('Powercast: Get topic and configuration.');\n        try {\n          var response=await powercastGetConfiguration(appConfig.powercastConnector[0].connector_config_endpoint); \n          console.debug('PowerCast: Get configuration response: ',JSON.stringify(response));\n          setconfiguration(JSON.stringify(response));\n        } catch(err) {     \n          console.debug('PowerCast: Get configuration error: ',err.message);\n          setconfiguration(err.message);\n        }\n    }\n\n\n    const getAuthorizationClick= async() => {\n        console.debug('Powercast: Getting auth.');\n        try {\n   //       const myhub=getHub();\n     //     var response=await powercastGetContext(myhub,topic); \n     //     console.debug('FHIRcast: Get Context response: ',JSON.stringify(response));\n            // setconfiguration(JSON.stringify(response));\n            setconfiguration('\"authorization_endpoint\": \"https://nuance-auth0-server/oauth/authorize\"');\n   //       alert(JSON.stringify(response));\n        } catch(err) {\n          \n  \n        }\n    }\n\n    return (\n    <>\n      <div className=\"ohif-scrollbar  overflow-y-auto overflow-x-hidden text-primary-light  text-base\"> \n      <Button \n        type={ButtonEnums.type.secondary}\n        onClick= {getConfigurationClick}\n        size='small'\n        >Get configuration\n      </Button>\n      <textarea className=\"text-[10px] text-black\"\n        id='configuration' \n        readOnly\n        value={configuration}  \n        rows={6} \n        cols={40} \n      />\n      <br/><hr/>\n      <Button \n        type={ButtonEnums.type.secondary}\n        onClick= {getAuthorizationClick}\n        size='small'    \n        >Get Authorization\n      </Button>\n      <textarea className=\"text-[10px] text-black\"\n        id='authorization' \n        readOnly\n        value={authorization}  \n        rows={6} \n        cols={40} \n        />\n        </div>\n    </>\n  );\n}\n\nexport default PowercastPanel;","\nexport async function powercastGetConfiguration(connector_endpoint) {\n    const requestOptions = {\n        method: 'GET',\n        headers: { 'Content-Type': 'application/json' },\n    };\n    try {\n        const response = await fetch(connector_endpoint,requestOptions);\n        if (response.status==200) {\n            const config= await response.json();\n            return(config); \n        }\n    }\n    catch(err) {\n        console.debug('PowerCast: Error getting configuration.', err.message);\n    }\n}\nexport async function powercastGetToken(hub ,topic, eventCallback) {\n    const endpoint='1231234414';\n   // Create a URL object with the current location\n    const urlObj = new URL(window.location.origin + window.location.pathname + location.search+'/fhircastCallback');\n    console.debug(URL.url);\n    var formData  ='hub.callback=http://localhost:3000/fhircastCallback';\n    formData +='&hub.mode=subscribe' ;\n    formData +='&hub.events='   +hub.events;\n    formData +='&hub.secret='   +hub.secret;\n    formData +='&hub.topic=' + topic   ;\n    formData +='&hub.lease='    +hub.lease;\n    formData +='&hub.channel.type=websocket';\n    formData +='&hub.channel.endpoint='+endpoint;\n    const requestOptions = {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n        body: formData\n    };\n    try {\n        const response = await fetch(hub.url,requestOptions);\n        if (response.status==202) {\n            console.debug('FHIRcast: Subscription accepted by hub. opening websocket.');\n            //  open websocket\n            var protocol='ws:';\n            const url= new URL(hub.url);\n            if (hub.url.includes('https:')) { protocol='wss:';}\n            const wsEvents = new WebSocket(protocol+'//' + url.host + '/bind/'+endpoint);\n            wsEvents.onopen = function () {\n                console.debug('FHIRcast: websocket is connected.');\n                //wsEvents.send('bind:'+hubs[0].endpoint);  ?? Nuance wants the endpoint back after connection I think      \n            }       \n            wsEvents.onmessage = function (ev) {\n                console.debug('FHIRcast: websocket received data.');\n                eventCallback(ev.data);\n            }\n            wsEvents.onclose = function () {\n                console.debug('FHIRcast: websocket is closed.');\n                // set status of hub to disconnected here\n            }\n            var subscribedHub=new fhircastHubClass();\n            subscribedHub.url=hub.url;\n            subscribedHub.topic=topic;\n            subscribedHub.name=hub.name;\n            subscribedHub.status=\"connected\";\n            return subscribedHub;\n        }\n        else {\n            console.debug('FHIRcast: Subscription rejected by hub:',response.status);\n        }\n    }\n    catch(err) {\n        console.debug('FHIRcast: Error subscribing to the hub.', err.message);\n    }\n}","\nimport React from 'react';\nimport { CustomizationService } from '@ohif/core';\nimport { ServicesManager, CommandsManager, ExtensionManager } from '@ohif/core';\n\nexport function CallbackCheck() {\n  console.debug('FHIRcast:  callback called'); \n  return('{hub.topic=\"FHIRcast conference\",hub.challenge=\"secret\"}'); \n\n  //'{hub.topic=\"FHIRcast conference\",hub.chalenge=\"secret\"}',\n} \n\n\nexport default function getCustomizationModule({ servicesManager, extensionManager }) {\n  return [\n    {\n      name: 'fhircastCallback',\n      value: {\n        id: 'customRoutes',\n        routes: [\n          {\n            path: '/fhircastCallback',\n            children: () => <CallbackCheck/>,\n             // console.debug('FHIRcast:  callback called');\n            // return('{hub.topic=\"FHIRcast conference\",hub.chalenge=\"secret\"}'); //'{hub.topic=\"FHIRcast conference\",hub.chalenge=\"secret\"}',     \n          },\n        ],\n      },\n    },\n\n  ]\n}\n","import { Icon } from '@ohif/ui';\nimport { ButtonEnums } from '@ohif/ui';\nimport React, { ReactElement, useState, useCallback } from 'react';\nimport { Button, InputFilterText } from '@ohif/ui';\n\nexport function ConferenceModal({onClose}): ReactElement {\n\n  return(\n  <div className=\"flex min-h-full w-full flex-col justify-between\"> \n  Would you like to join?\n  <Button name=\"Yes\"\n           size={ButtonEnums.size.medium}\n            type={ButtonEnums.type.secondary}\n            onClick={onClose}\n          >Yes</Button>\n  <Button name=\"No\"\n           size={ButtonEnums.size.medium}\n            type={ButtonEnums.type.secondary}\n            onClick={onClose}\n          >No</Button>\n  </div>);\n}\n","/*\nFhircastService\n\n  public async fhircastPublish(fhircastMessage) -returns response.status\n  public async fhircastGetContext() = returns context object\n\n  processEvent\n\n  public async getToken() \n  public async fhircastSubscribe() \n  public async fhircastUnsubscribe() \n\n  public setHub(hubName: string) : boolean\n  public getHub() : returns the hub object if set.\n  public setTopic(topic: string) \n  public getTopic(topic: string) :string\n \n*/\nimport { PubSubService, ServicesManager,CommandsManager ,ExtensionManager, } from '@ohif/core';\nimport OHIF, { Types, errorHandler } from '@ohif/core';\nimport { AppConfig } from '../../../ohif/Viewers/platform/core/src/types';\nimport {ConferenceModal} from './conferenceModal'\n\nconst EVENTS = {\n  FHIRCAST_MESSAGE: 'fhircastMessage',\n  HUB_SUBSCRIBED: 'hubSubscribed',\n  HUB_UNSUBSCRIBED: 'hubUnsubscribed',\n  WEBSOCKET_CLOSE: 'websocketClose',\n  TOKEN_ACQUIRED: 'tokenAcquired',\n  STUDY_CLOSE: 'studyClose',\n};\n\nclass FhircastService extends PubSubService {\n  private _extensionManager: ExtensionManager;\n  private _servicesManager: ServicesManager;\n  private _commandsManager: CommandsManager;\n  private _appConfig: AppConfig;\n\n  public static readonly EVENTS = EVENTS;\n\n  public static REGISTRATION = {\n    name: 'fhircastService',\n    altName: 'FhircastService',\n    create: ({ extensionManager, commandsManager, servicesManager,appConfig}) => {\n      return new FhircastService(extensionManager, commandsManager, servicesManager,appConfig);\n    },\n  };\n  \n  public hub={\n    name: '',\n    friendlyName: '',\n    productName : '',\n    enabled: false,\n    events: [],\n    lease:999,\n    hub_endpoint: '',\n    authorization_endpoint: '',\n    token_endpoint: '',\n    token:'',\n    subscriberName:'',\n    topic: '',\n    lastPublishedMessageID: '',  // to filter event echo\n    subscribed:false,\n    resubscribeRequested: false,\n    websocket: null \n  };\n\n  public conferenceApproved=false;\n\n  private readonly fhircastConfig=window.config.fhircast;\n\n  \n  constructor(\n    extensionManager: ExtensionManager,\n    commandsManager: CommandsManager,\n    servicesManager: ServicesManager,\n    appConfig: AppConfig\n  ) {\n    console.debug('FhircastService: creating service '  );\n    super(EVENTS);\n    this._extensionManager = extensionManager;\n    this._commandsManager = commandsManager;\n    this._servicesManager = servicesManager;\n    //this ._appConfig=appConfig;\n    //const fhircastConfig=this._appConfig.fhircast;\n    if (this.fhircastConfig.defaultHub){   \n      const result=this.setHub(this.fhircastConfig.defaultHub);  \n      if (this.fhircastConfig.autoStart) { this.getToken(); } \n    }   \n    const interval = setInterval(()=> {this.checkWebsocket(interval);},10000);\n    \n  }\n \n  private checkWebsocket= async(interval) => {  // resubscribe every 10secs if the websocket disconnects\n    //console.debug('FhircastService: checking websocket '  );\n\n    if ( this.hub.resubscribeRequested && this.hub.subscribed && this.fhircastConfig.autoReconnect) {\n      console.debug('FhircastService: Try to resubscribe '  );\n      this.hub.resubscribeRequested=false;\n      var response= await this.fhircastSubscribe();\n      if (response==202) {\n        this.hub.resubscribeRequested=false;\n      } else {\n        this.hub.resubscribeRequested=true; \n      }\n    }\n    else if (!this.hub.subscribed && this.hub.resubscribeRequested) {\n      this.hub.resubscribeRequested=false;\n    }\n  }\n\n  public createImagingStudyClose(StudyUID:string){\n    var message={\n      timestamp: '',\n      id: '',\n      event: {\n        'hub.topic': '',\n        'hub.event': 'imagingstudy-close',\n        context: []\n      }\n    }\n    return(message);\n  }\n\n\n  public createImagingStudyOpen(StudyUID:string){\n    var message={\n    timestamp: '',\n    id: '',\n    event: {\n      'hub.topic': '',\n      'hub.event': 'imagingstudy-open',\n      context: [\n        {\n          key: \"patient\",\n          resource: {\n            resourceType: 'Patient',\n            id: 'ewUbXT9RWEbSj5wPEdgRaBw3',\n            identifier: [\n              {\n                system: 'urn:oid:1.2.840.114350',\n                value: '185444'\n              },\n              {\n                system: 'urn:oid:1.2.840.114350.1.13.861.1.7.5.737384.27000',\n                value: '2667'\n              }\n            ]\n          }\n        },\n        {\n          key: 'study',\n          resource: {\n            resourceType: 'ImagingStudy',\n            id: '',  // FHIR id\n            uid: 'urn:oid:' + StudyUID ,\n            identifier: [\n              {\n                system: '7678',\n                value: ''  // acc nbr\n              }\n            ],\n            patient: {\n              reference: 'Patient/ewUbXT9RWEbSj5wPEdgRaBw3'  \n            }\n          }\n        }\n      ]   \n    }\n    \n    }\n    return(message);\n  }\n\n  public setHub(hubName: string) : boolean {\n    if (hubName===this.hub.name) {\n      console.debug('FhircastService: setHub: hub already set to ' + hubName );\n      return(true);\n    }  \n    console.debug('FhircastService: setting hub to ' + hubName );\n    try {\n      if (this.fhircastConfig.hubs) {\n        this.fhircastConfig.hubs.forEach(hubconfig =>{\n          if (hubconfig.enabled && hubconfig.name===hubName) {\n            if (this.hub.subscribed) {this.fhircastUnsubscribe();}\n            this.hub=hubconfig;\n            this.hub.subscribed=false;\n            return(true);\n          }\n        });\n      } \n      else {\n        console.debug('FhircastService: hub not found in configuration ' + hubName );\n        return(false);\n      }\n    } catch(err) {\n      console.warn('FhircastService: Unable to set the hub to  ' + hubName );\n      return(false);\n    }  \n  }\n  \n  public getHub() {\n    console.debug('FhircastService: getHub: hub is ' + this.hub.name );\n    return(this.hub) ;\n  }\n\n  public getTopic(topic: string) :string {\n    console.debug('FhircastService: getTopic called.'  );\n    return(this.hub.topic);\n  }\n\n  public setTopic(topic: string)  {\n    console.debug('FhircastService: setting topic to ' +topic );\n    this.hub.topic=topic;\n    this.hub.subscriberName='OHIF-'+topic+'-'+Math.random().toString(36).substring(2, 16);\n  }\n\n  public async getToken()  {\n    console.debug('FhircastService: Getting token.');\n    const tokenFormData= new URLSearchParams();  \n    tokenFormData.append('grant_type','client_credentials');\n    tokenFormData.append('client_id',process.env.REACT_APP_FHIRCAST_CLIENT_ID);\n    tokenFormData.append('client_secret',process.env.REACT_APP_FHIRCAST_CLIENT_SECRET);\n    const requestOptions = {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n        body: tokenFormData\n    };\n    try {\n      const response = await fetch(this.hub.token_endpoint,requestOptions);\n      if (response.status==200) {\n          const config= await response.json();\n          if (config.access_token) {\n              console.debug('FhircastService:  Token received: ',config.access_token);\n              this.hub.token=config.access_token\n              this._broadcastEvent(FhircastService.EVENTS.TOKEN_ACQUIRED,{})\n          }\n          if (config.topic) {\n            console.debug('FhircastService:  Topic received: ',config.topic);\n            this.setTopic(config.topic);\n            if (this.fhircastConfig.autoStart) { \n              this.fhircastSubscribe(); \n              let studyUID=null;\n              const currentContext= await this.fhircastGetContext();\n              console.debug('FhircastService: current context is: '+JSON.stringify(currentContext));\n              if (currentContext && JSON.stringify(currentContext)!=='{}') {\n                currentContext.forEach(contextResource => {\n                  if (contextResource.key.toLowerCase()==='study') {\n                    studyUID=contextResource.resource.uid.replaceAll('urn:oid:','');\n                    console.debug('FhircastPanel: opening on startup with current context: '+studyUID);\n                   try { this._commandsManager.runCommand('navigateHistory',{to:'/viewer?StudyInstanceUIDs='+studyUID+'&FHIRcast'}); }\n                   catch(err) {console.debug('FhircastPanel:error  opening on startup with current context: '+err);}\n                  }\n                });\n              }        \n            } \n          }\n          return(true); \n      }\n\n      else {\n        console.debug('FhircastService: Error getting token.');\n        return(false);         \n      }\n    }\n    catch(err) {\n        console.warn('FhircastService: Error getting token:', err.message);\n        return(false);\n    }\n  }\n\n  \n  public async fhircastUnsubscribe() {\n    this.hub.subscribed=false;\n    this.hub.resubscribeRequested=false;\n    const subscribeFormData= new URLSearchParams();  \n    subscribeFormData.append('hub.mode', 'unsubscribe');\n    subscribeFormData.append('hub.channel.type','websocket');\n    subscribeFormData.append('hub.callback',window.location.origin +'/fhircastCallback');\n    subscribeFormData.append('hub.events',this.hub.events.toString());\n    subscribeFormData.append('hub.topic',this.hub.topic);\n    subscribeFormData.append('hub.lease',this.hub.lease.toString());\n    subscribeFormData.append('subscriber.name',this.hub.subscriberName);\n    const requestOptions = {\n        method: 'POST',\n        headers: {  'Content-Type': 'application/x-www-form-urlencoded',\n                    'Authorization': 'Bearer ' +this.hub.token\n                },\n        body: subscribeFormData,\n        signal: AbortSignal.timeout(5000)\n    };\n    try {\n        const response = await fetch(this.hub.hub_endpoint,requestOptions);\n        if (response.status==202) {    \n          const subscriptionResponse=await response.json();\n          console.debug('FhircastService: Unsubscribe successfully from hub '+this.hub.name);  \n          this._broadcastEvent(FhircastService.EVENTS.HUB_UNSUBSCRIBED,{});     \n        }\n        else {\n          console.debug('FhircastService: Unsubscribe refused by the hub. ');  \n        }\n      }\n      catch(err) {\n        console.warn('FhircastService: Error unsubscribing from the hub.', err.message);\n      }\n      if (this.hub.websocket) {this.hub.websocket.close();}\n      \n  }\n\n\n  private processEvent(eventData) {\n    try {           \n      const fhirMessage=JSON.parse(eventData);\n      if (fhirMessage['hub.mode']) {\n        console.debug('FhircastService: Subscription acknowledged on the websocket.');             \n      }\n      if (fhirMessage.event) {                    \n        if (fhirMessage.event['hub.event']==='heartbeat') {\n          console.debug('FhircastService: Received websocket heartbeat from hub '+this.hub.name);\n        }\n        else if (fhirMessage.id===this.hub.lastPublishedMessageID) {\n          console.debug('FhircastService: Received echo of event '+fhirMessage.event['hub.event']+', id:'+fhirMessage.id);       \n        } \n        else if (fhirMessage.event) \n        {            \n          console.debug('FhircastService: websocket received data: ',eventData);  \n          this._broadcastEvent(FhircastService.EVENTS.FHIRCAST_MESSAGE,{}); \n          let currentLocation=window.location.search;                           \n          if ( fhirMessage.event['hub.event'].toLowerCase()==='patient-open') {\n            if (fhirMessage.event.context) {\n              var mrn=null;\n              fhirMessage.event.context.forEach(contextResource => {\n                if (contextResource.key.toLowerCase()==='patient') {\n                  mrn=contextResource.resource.identifier[0].value;\n                }\n              });\n              console.debug('FhircastService: patient-open for mrn:'+mrn);\n              this._commandsManager.runCommand('navigateHistory',{to:'/?mrn='+mrn});\n            }  \n            else {\n              console.warn('FhircastService: mrn not found in  patient-open message.');\n            }               \n          }\n          if ( currentLocation!='' && fhirMessage.event['hub.event'].toLowerCase()==='patient-close') {\n            this._commandsManager.runCommand('navigateHistory',{to:'/'});\n          }\n          if (  fhirMessage.event['hub.event'].toLowerCase()==='imagingstudy-open') {\n            var studyUID=null;\n            fhirMessage.event.context.forEach(contextResource => {\n              if (contextResource.key.toLowerCase()==='study') {\n                studyUID=contextResource.resource.uid.replaceAll('urn:oid:','');\n              }\n            });\n            if (studyUID!==null && !currentLocation.includes(studyUID)){\n              console.debug('FhircastService:  imagingstudy-open, opening '+studyUID);\n              this._commandsManager.runCommand('navigateHistory',{to:'/viewer?StudyInstanceUIDs='+studyUID+'&FHIRcast'});\n            }\n            else if (studyUID===null) {\n              console.debug('FhircastService:  imagingstudy-open, studyUID not found in message');              \n            } else if (currentLocation.includes(studyUID)) {\n              console.debug('FhircastService:  imagingstudy-open, studyUID already open'); \n            }\n          }\n          if (  currentLocation!='' && fhirMessage.event['hub.event'].toLowerCase()==='imagingstudy-close') {\n            this._commandsManager.runCommand('navigateHistory',{to:'/'});\n          }\n          if ( fhirMessage.event['hub.event'].toLowerCase()==='diagnosticreport-open') {\n            const studyUID=fhirMessage.event.context[1].identifier[0].value;\n            console.debug('FhircastService:  Opening '+studyUID);\n            this._commandsManager.runCommand('navigateHistory',{to:'/viewer?StudyInstanceUIDs='+studyUID});\n          }\n          if (  currentLocation!='' && fhirMessage.event['hub.event'].toLowerCase()==='diagnosticreport-close') {\n            console.debug('FhircastService:  Closing viewer');\n            this._commandsManager.runCommand('navigateHistory',{to:'/'});\n          }\n          if (fhirMessage.event['hub.topic'].toLowerCase()!==this.hub.topic) {\n            console.debug('FhircastService:  Conference starting');\n            const { UIModalService } = this._servicesManager.services;          \n            if (!this.conferenceApproved) {\n              UIModalService.show({content: ConferenceModal,\n                                title: fhirMessage.event['hub.topic']+' conference starting!', });\n            }\n            this.conferenceApproved=true;  \n          }\n        }              \n      }   \n    } catch(err){\n      console.warn('FhircastService: websocket processing error: ',err);\n    }       \n  } \n\n\nprivate onClose() {\n\n}\n\n  private websocketClose() {\n    console.debug('FhircastService: websocket is closed.');\n    this.hub.resubscribeRequested=true;\n    this._broadcastEvent(FhircastService.EVENTS.WEBSOCKET_CLOSE,{});\n  }\n\n  public async fhircastSubscribe() {\n    if (this.hub.topic===undefined ) {\n      console.warn('FhircastService: Error. subscription not sent. No topic defined.');\n      return ('error: topic not defined');\n    }\n    const subscribeFormData= new URLSearchParams();  \n    subscribeFormData.append('hub.mode', 'subscribe');\n    subscribeFormData.append('hub.channel.type','websocket');\n    subscribeFormData.append('hub.callback',window.location.origin +'/fhircastCallback');\n    subscribeFormData.append('hub.events',this.hub.events.toString());\n    subscribeFormData.append('hub.topic',this.hub.topic);\n    subscribeFormData.append('hub.lease',this.hub.lease.toString());\n    subscribeFormData.append('subscriber.name',this.hub.subscriberName);\n    const requestOptions = {\n        method: 'POST',\n        headers: {  'Content-Type': 'application/x-www-form-urlencoded',\n                    'Authorization': 'Bearer ' +this.hub.token\n                },\n        body: subscribeFormData,\n        signal: AbortSignal.timeout(5000)\n    };\n    try {\n      const response = await fetch(this.hub.hub_endpoint,requestOptions);\n      if (response.status==202) {    \n        this.hub.subscribed=true;\n        this.hub.resubscribeRequested=false;\n        const subscriptionResponse=await response.json();\n        console.debug('FhircastService: subscribe response: '+JSON.stringify(subscriptionResponse));\n        const websocket_url=subscriptionResponse['hub.channel.endpoint'];           \n        this.hub.websocket = new WebSocket(websocket_url); //  open websocket  \n        this.hub.websocket.onopen = function () {\n          console.debug('FhircastService: websocket is connected.'); // Nuance wants the endpoint back after connection I think      \n          this.send('{\"hub.channel.endpoint\":\"'+websocket_url+'\"}');\n        }        \n        this.hub.websocket.addEventListener('message',(ev)=>this.processEvent(ev.data)) ;\n        this.hub.websocket.addEventListener('close',()=>this.websocketClose()) ;\n        this.hub.websocket.onerror = function () {console.warn('FhircastService: Error reported on websocket:'); }\n  \n        this._broadcastEvent(FhircastService.EVENTS.HUB_SUBSCRIBED,{});\n  \n      }\n      else if (response.status==401) { \n        console.debug('FhircastService: Subscription response 401 -Token refresh needed here.');\n        this.getToken();        \n      }\n      else {\n        console.debug('FhircastService: Subscription rejected by hub:',response.status);   \n      }\n      return(response.status);   \n    }\n    catch(err) {\n        console.warn('FhircastService: Error subscribing to the hub.', err.message);\n    }\n  }\n\n  public async fhircastPublish(fhircastMessage) {\n    const timestamp= new Date();\n    fhircastMessage.timestamp = timestamp.toJSON();\n    fhircastMessage.id = 'OHIF-'+Math.random().toString(36).substring(2, 16);\n    this.hub.lastPublishedMessageID=fhircastMessage.id;  // to filter event echo from the hub\n    fhircastMessage.event['hub.topic'] = this.hub.topic;\n    const message = JSON.stringify(fhircastMessage); \n    const requestOptions = {\n        method: 'POST',\n        headers: {  'Content-Type': 'application/json' , \n                    'Authorization': 'Bearer ' +this.hub.token\n                },\n        body: message\n    };\n    try {\n        console.debug(\"FhircastService: Publishing message to FHIRcast hub: \" + message)\n        var hubEndpoint=this.hub.hub_endpoint+'/'+this.hub.topic;\n        if (this.hub.productName==='PHILIPS') {\n            hubEndpoint=this.hub.hub_endpoint;\n        }\n        const response = await fetch(hubEndpoint,requestOptions);\n        return(response);\n    }\n    catch(err) {\n        console.debug(err.message);\n        return(null);\n    }\n  }\n\n  public async fhircastGetContext() {\n    console.debug(\"FhircastService: Retrieving context from FHIRcast hub.\");\n    try {\n      const requestOptions = {\n          method: 'GET',\n          headers: { 'Content-Type': 'application/json',\n          'Authorization': 'Bearer ' +this.hub.token\n          }\n      };\n      const response = await fetch(this.hub.hub_endpoint+'/'+this.hub.topic,requestOptions);\n      const context= await response.json();\n      return(context);\n    } catch(err) {\n          console.warn('FhircastService: get context error: ',err.message);\n          return(err.text);\n    }\n  } \n\n}\n\nexport default FhircastService;\nexport { EVENTS };\n\n\n","import { id } from './id';\nimport getPanelModule from './fhircast/getPanelModule';\nimport getCustomizationModule from './fhircast/getCustomizationModule';\nimport { ServicesManager, ExtensionManager, CommandsManager, DicomMetadataStore } from '@ohif/core';\nimport FhircastService from './services/FhircastService';\n\n\n\n\nexport default {\n\n  id,\n\n  //preRegistration: ({ servicesManager, commandsManager, configuration = {} }) => {\n    preRegistration: ({ servicesManager, commandsManager, extensionManager, configuration = {}}) => {\n\n      servicesManager.registerService(FhircastService.REGISTRATION);\n  },\n\n \n\n  getPanelModule,\n\n  getCustomizationModule,\n\n\n\n};\n","import React from 'react';\nimport { ServicesManager, CommandsManager, ExtensionManager } from '@ohif/core';\nimport { useViewportGrid } from '@ohif/ui';\nimport { MeasurementTable } from '@ohif/ui';\nimport FhircastPanel from './FhircastPanel';\nimport PowercastPanel from './PowercastPanel';\n\n\nexport default function getPanelModule({\n  commandsManager,\n  extensionManager,\n  servicesManager,\n}: {\n  servicesManager: ServicesManager;\n  commandsManager: CommandsManager;\n  extensionManager: ExtensionManager;\n}) {\n\n  const wrappedPowercastPanel = () => {\n    const [{ activeViewportId, viewports }] = useViewportGrid();\n\n    return (\n      <PowercastPanel\n        viewports={viewports}\n        activeViewportId={activeViewportId}\n        onSaveComplete={() => {}}\n        onRejectComplete={() => {}}\n        commandsManager={commandsManager}\n        servicesManager={servicesManager}\n        extensionManager={extensionManager}\n      />\n    );\n  };\n\n\n  const wrappedFhircastPanel = () => {\n    const [{ activeViewportId, viewports }] = useViewportGrid();\n\n    return (\n      <FhircastPanel\n        viewports={viewports}\n        activeViewportId={activeViewportId}\n        onSaveComplete={() => {}}\n        onRejectComplete={() => {}}\n        commandsManager={commandsManager}\n        servicesManager={servicesManager}\n        extensionManager={extensionManager}\n      />\n      \n    );\n  };\n\n\n\n  return [\n    {\n      name: 'PowercastPanel',\n      iconName: 'power-off',\n      iconLabel: 'power-off',\n      label: 'Powercast',\n      secondaryLabel: 'Measurements',\n      component: wrappedPowercastPanel,\n    },\n    {\n      name: 'FhircastPanel',\n      iconName: 'power-off',\n      iconLabel: 'power-off',\n      label: 'FHIRcast',\n      secondaryLabel: 'Measurements',\n      component: wrappedFhircastPanel,\n    },\n\n  ];\n}\n"],"names":["label","value","eventObject","servicesManager","commandsManager","extensionManager","FhircastService","services","hubConnected","sethubConnected","useState","tokenAcquired","setTokenAcquired","topic","setTopic","publishEvent","setPublishEvent","selectedHub","setSelectedHub","overwriteDataCheckbox","setOverwriteDataCheckbox","patientOpenCheckbox","setPatientOpenCheckbox","patientCloseCheckbox","setPatientCloseCheckbox","imagingStudyOpenCheckbox","setImagingStudyOpenCheckbox","imagingStudyCloseCheckbox","setImagingStudyCloseCheckbox","diagnosticReportOpenCheckbox","setDiagnosticReportOpenCheckbox","diagnosticReportCloseCheckbox","setDiagnosticReportCloseCheckbox","sendIMOpen","setSendIMOpen","sendIMClose","setSendIMClose","appConfig","useAppConfig","hub","name","friendlyName","productName","enabled","events","lease","hub_endpoint","authorization_endpoint","token_endpoint","token","subscribed","subscriberName","useEffect","getHub","getTopic","fhircastEvent","EVENTS","FHIRCAST_MESSAGE","hubSubscribed","HUB_SUBSCRIBED","hubUnsubscribed","HUB_UNSUBSCRIBED","websocketClose","WEBSOCKET_CLOSE","subscriptions","forEach","evt","unsubscribe","subscribe","console","debug","push","unsub","patientOpenCheckboxClick","diagnosticReportOpenCheckboxClick","React","className","Select","id","options","fhircast","hubs","onChange","changeHub","selected","setHub","Button","type","ButtonEnums","secondary","disabled","onClick","async","getToken","size","Label","InputText","newValue","undefined","fhircastSubscribe","fhircastUnsubscribe","response","fhircastGetContext","JSON","stringify","alert","err","warn","message","checked","testData","defaultValue","eventObj","filter","e","event","toLowerCase","viewportGridService","displaySetService","cornerstoneViewportService","displaySet","getActiveDisplaySets","instance","instances","StudyInstanceUID","context","resource","uid","fhircastPublish","statusText","overwriteDataCheckboxClick","patientCloseCheckboxClick","imagingStudyOpenCheckboxClick","imagingStudyCloseCheckboxClick","sendIMOpenCheckboxClick","sendIMCloseCheckboxClick","configuration","setconfiguration","authorization","setWauthorization","connector_endpoint","requestOptions","method","headers","fetch","status","json","powercastGetConfiguration","powercastConnector","connector_config_endpoint","readOnly","rows","cols","CallbackCheck","ConferenceModal","onClose","medium","TOKEN_ACQUIRED","STUDY_CLOSE","PubSubService","constructor","super","_extensionManager","_servicesManager","_commandsManager","_appConfig","lastPublishedMessageID","resubscribeRequested","websocket","conferenceApproved","fhircastConfig","window","config","checkWebsocket","this","autoReconnect","defaultHub","autoStart","interval","setInterval","createImagingStudyClose","StudyUID","timestamp","createImagingStudyOpen","key","resourceType","identifier","system","patient","reference","hubName","hubconfig","Math","random","toString","substring","tokenFormData","URLSearchParams","append","process","body","access_token","_broadcastEvent","studyUID","currentContext","contextResource","replaceAll","runCommand","to","subscribeFormData","location","origin","signal","AbortSignal","timeout","close","processEvent","eventData","fhirMessage","parse","currentLocation","search","mrn","includes","UIModalService","show","content","title","subscriptionResponse","websocket_url","WebSocket","onopen","send","addEventListener","ev","data","onerror","fhircastMessage","Date","toJSON","hubEndpoint","text","_FhircastService","REGISTRATION","altName","create","preRegistration","registerService","getPanelModule","iconName","iconLabel","secondaryLabel","component","wrappedPowercastPanel","activeViewportId","viewports","useViewportGrid","PowercastPanel","onSaveComplete","onRejectComplete","wrappedFhircastPanel","FhircastPanel","getCustomizationModule","routes","path","children"],"sourceRoot":""}